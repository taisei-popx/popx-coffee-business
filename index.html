<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>popx coffee lab â€” Business Structure & Revenue Simulation</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root {
    --color-navy: #243668;
    --color-pink: #ff9fb4;
    --color-cyan: #7af2e0;
    --color-bg: #fcfcfc;
    --color-text: #4b3e3c;
    --font-heading: 'Montserrat', 'Noto Sans JP', sans-serif;
    --font-body: 'Noto Sans JP', sans-serif;
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family: var(--font-body);
    background: var(--color-bg);
    color: var(--color-text);
    letter-spacing: 0.05em;
    font-feature-settings: "palt" 1;
    padding-top: 80px;
}
header {
    background: #fff;
    color: var(--color-text);
    padding: 20px 0;
    text-align: center;
    border-bottom: 1px solid rgba(0,0,0,0.08);
    box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    position: fixed;
    top: 0;
    width: 100%;
    z-index: 1000;
}
header h1 { font-family: var(--font-heading); font-size: 22px; font-weight: 800; letter-spacing: 0.15em; color: var(--color-navy); }
header p { font-size: 13px; opacity: 0.7; margin-top: 4px; }
header .hub-link {
    position: absolute; left: 24px; top: 50%; transform: translateY(-50%);
    font-size: 12px; color: var(--color-navy); text-decoration: none;
    border: 1px solid rgba(36,54,104,0.3); padding: 6px 12px; border-radius: 100vh; transition: all 0.2s;
}
header .hub-link:hover { background: rgba(36,54,104,0.05); border-color: var(--color-navy); }
.container { max-width: 1200px; margin: 0 auto; padding: 24px 16px; }
.section-title {
    font-family: var(--font-heading); font-size: 13px; font-weight: 700; color: var(--color-navy);
    letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 20px;
    padding-bottom: 10px; border-bottom: 2px solid var(--color-cyan);
}
.tab-bar { display: flex; gap: 8px; margin-bottom: 28px; flex-wrap: wrap; }
.tab-btn {
    font-family: var(--font-heading); font-size: 12px; font-weight: 600; letter-spacing: 0.05em;
    padding: 8px 20px; border-radius: 100vh; border: 1px solid rgba(36,54,104,0.2);
    background: white; color: var(--color-navy); cursor: pointer; transition: all 0.2s;
}
.tab-btn:hover { border-color: var(--color-navy); background: rgba(36,54,104,0.03); }
.tab-btn.active { background: var(--color-navy); color: white; border-color: var(--color-navy); }
.card {
    background: white; border-radius: 16px; padding: 24px;
    border: 1px solid rgba(0,0,0,0.08); margin-bottom: 20px;
}
.card h3 {
    font-family: var(--font-heading); font-size: 13px; font-weight: 700;
    color: var(--color-navy); letter-spacing: 0.08em; text-transform: uppercase; margin-bottom: 16px;
}
.card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-bottom: 20px; }
.struct-table { width: 100%; border-collapse: collapse; font-size: 14px; }
.struct-table th {
    background: #f8f9fc; padding: 10px 14px; text-align: left;
    font-family: var(--font-heading); font-size: 11px; font-weight: 700;
    letter-spacing: 0.06em; color: var(--color-navy); border-bottom: 2px solid rgba(36,54,104,0.1);
}
.struct-table td { padding: 10px 14px; border-bottom: 1px solid rgba(0,0,0,0.05); line-height: 1.6; }
.struct-table tr:last-child td { border-bottom: none; }
.badge {
    display: inline-block; font-size: 10px; font-weight: 700; letter-spacing: 0.05em;
    padding: 3px 10px; border-radius: 100vh; font-family: var(--font-heading);
}
.badge-popx { background: var(--color-navy); color: white; }
.badge-greekee { background: var(--color-pink); color: white; }
.badge-shared { background: var(--color-cyan); color: var(--color-navy); }
.badge-s2-pool {
    background: linear-gradient(135deg, #f59e0b, #d97706); color: white;
    font-size: 10px; font-weight: 700; padding: 3px 10px; border-radius: 100vh;
    font-family: var(--font-heading); display: inline-block; letter-spacing: 0.05em;
}
.badge-s2-ready {
    display: inline-block; background: #059669; color: white;
    font-size: 10px; font-weight: 700; padding: 4px 12px; border-radius: 100vh; font-family: var(--font-heading);
}
.split-bar-container { margin: 8px 0; }
.split-bar {
    display: flex; height: 32px; border-radius: 8px; overflow: hidden;
    font-size: 11px; font-weight: 700; font-family: var(--font-heading);
}
.split-popx {
    background: var(--color-navy); color: white;
    display: flex; align-items: center; justify-content: center; transition: width 0.4s ease;
}
.split-greekee {
    background: var(--color-pink); color: white;
    display: flex; align-items: center; justify-content: center; transition: width 0.4s ease;
}
.split-label { display: flex; justify-content: space-between; font-size: 11px; color: #999; margin-top: 4px; }
.cost-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f0f0f0; font-size: 14px; }
.cost-row:last-child { border-bottom: none; }
.cost-label { color: #666; }
.cost-value { font-weight: 700; color: var(--color-navy); }
.cost-value.red { color: #e74c3c; }
.cost-value.green { color: #059669; }
.cost-total { background: #f8f9fc; margin: 12px -24px -24px; padding: 16px 24px; border-radius: 0 0 16px 16px; }
.cost-total .cost-row { border: none; font-size: 16px; }
.control-group { margin-bottom: 16px; }
.control-label { font-size: 12px; font-weight: 600; color: #666; margin-bottom: 6px; display: flex; justify-content: space-between; }
.control-val { color: var(--color-navy); font-size: 14px; font-weight: 700; }
input[type="range"] {
    width: 100%; height: 6px; -webkit-appearance: none; appearance: none;
    background: #e0e0e0; border-radius: 3px; outline: none;
}
input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%;
    background: var(--color-navy); cursor: pointer; border: 3px solid white;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}
.result-banner {
    background: linear-gradient(135deg, var(--color-navy), #1a284d);
    color: white; border-radius: 16px; padding: 32px; text-align: center; margin: 24px 0;
}
.result-banner h2 { font-family: var(--font-heading); font-size: 13px; letter-spacing: 0.1em; opacity: 0.8; margin-bottom: 8px; }
.result-big { font-family: var(--font-heading); font-size: 40px; font-weight: 800; }
.result-big.positive { color: var(--color-cyan); }
.result-big.negative { color: var(--color-pink); }
.result-sub { font-size: 13px; opacity: 0.7; margin-top: 8px; }
.result-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-top: 24px; }
.result-item { text-align: center; }
.result-item .ri-val { font-family: var(--font-heading); font-size: 22px; font-weight: 700; }
.result-item .ri-label { font-size: 11px; opacity: 0.6; margin-top: 2px; }
.pattern-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(340px, 1fr)); gap: 20px; margin: 20px 0; }
.flow-container {
    background: white; border-radius: 16px; padding: 28px;
    border: 1px solid rgba(0,0,0,0.08); margin-bottom: 20px; overflow-x: auto;
}
.flow-diagram {
    display: flex; align-items: center; justify-content: center; gap: 12px;
    min-width: 600px; padding: 20px 0; flex-wrap: nowrap;
}
.flow-box {
    padding: 14px 18px; border-radius: 12px; font-size: 12px;
    font-weight: 600; text-align: center; min-width: 120px; line-height: 1.5;
}
.flow-revenue { background: #e8f5e9; border: 1px solid #a5d6a7; color: #2e7d32; }
.flow-topoff { background: #fff3e0; border: 1px solid #ffcc80; color: #e65100; }
.flow-profit { background: #e3f2fd; border: 1px solid #90caf9; color: #1565c0; }
.flow-pool { background: linear-gradient(135deg, #fef3c7, #fde68a); border: 1px solid #f59e0b; color: #92400e; }
.flow-popx { background: var(--color-navy); color: white; }
.flow-greekee { background: var(--color-pink); color: white; }
.flow-arrow { font-size: 20px; color: #ccc; flex-shrink: 0; }
.scenario-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
@media (max-width: 768px) {
    .scenario-grid { grid-template-columns: 1fr; }
    .flow-diagram { min-width: 500px; }
    .result-grid { grid-template-columns: 1fr 1fr; }
    .pattern-grid { grid-template-columns: 1fr; }
}
.tab-panel { display: none; }
.tab-panel.active { display: block; }
.stat-row { display: flex; gap: 16px; margin: 16px 0; flex-wrap: wrap; }
.stat-box {
    flex: 1; min-width: 140px; background: #f8f9fc; border-radius: 12px; padding: 16px; text-align: center;
}
.stat-box .stat-num { font-family: var(--font-heading); font-size: 24px; font-weight: 800; color: var(--color-navy); }
.stat-box .stat-label { font-size: 11px; color: #999; margin-top: 4px; }
.monthly-table { width: 100%; border-collapse: collapse; font-size: 12px; margin-top: 16px; }
.monthly-table th {
    background: var(--color-navy); color: white; padding: 8px 6px; text-align: right;
    font-family: var(--font-heading); font-size: 10px; font-weight: 600; letter-spacing: 0.05em;
}
.monthly-table th:first-child { text-align: left; border-radius: 8px 0 0 0; }
.monthly-table th:last-child { border-radius: 0 8px 0 0; }
.monthly-table td {
    padding: 7px 6px; text-align: right; border-bottom: 1px solid rgba(0,0,0,0.05);
    font-variant-numeric: tabular-nums;
}
.monthly-table td:first-child { text-align: left; font-weight: 600; color: var(--color-navy); }
.monthly-table tr:last-child td { font-weight: 700; background: #f8f9fc; }
.monthly-table .positive { color: #059669; }
.monthly-table .negative { color: #e74c3c; }
.note-box {
    background: #fffbf0; border: 1px solid #ffe0a0; border-radius: 12px;
    padding: 16px 20px; font-size: 13px; line-height: 1.7; margin: 16px 0; color: #8a6d3b;
}
.phase-timeline { display: flex; align-items: center; gap: 16px; margin: 24px 0; flex-wrap: wrap; }
.phase-box {
    flex: 1; min-width: 180px; background: white; border-radius: 12px;
    padding: 20px; border: 2px solid rgba(0,0,0,0.08); text-align: center;
}
.phase-box.s1 { border-color: var(--color-navy); }
.phase-box.s2 { border-color: var(--color-cyan); }
.phase-box.s3 { border-color: var(--color-pink); }
.phase-box h4 { font-family: var(--font-heading); font-size: 12px; font-weight: 700; color: var(--color-navy); margin-bottom: 8px; }
.phase-box p { font-size: 12px; color: #666; line-height: 1.5; }
.phase-arrow { font-size: 24px; color: #ccc; flex-shrink: 0; }
.formula-box {
    background: #f8f9fc; border-radius: 8px; padding: 12px 16px;
    font-size: 12px; font-family: 'Courier New', monospace;
    color: var(--color-navy); margin: 8px 0; line-height: 1.6;
}
.split-card { background: #f8f9fc; border-radius: 12px; padding: 16px; margin: 12px 0; }
.split-card-label { font-size: 12px; font-weight: 600; color: var(--color-navy); margin-bottom: 8px; }
.split-card-formula { font-size: 12px; font-family: 'Courier New', monospace; color: #666; margin-bottom: 8px; }
.split-card-result { font-size: 14px; font-weight: 700; color: var(--color-navy); }
/* Pooled state */
.pooled-overlay {
    position: relative;
}
.pooled-overlay::after {
    content: 'S2 ãƒ—ãƒ¼ãƒ«ä¸­';
    position: absolute; top: 8px; right: 8px;
    background: linear-gradient(135deg, #f59e0b, #d97706); color: white;
    font-size: 9px; font-weight: 700; padding: 2px 8px; border-radius: 100vh;
    font-family: var(--font-heading); letter-spacing: 0.05em;
}
.pooled-amount { color: #999 !important; text-decoration: line-through; font-size: 13px !important; }
.actual-amount { color: var(--color-navy); font-size: 16px; font-weight: 800; }
/* Investment cards */
.invest-card {
    background: white; border-radius: 16px; padding: 24px;
    border: 2px solid rgba(0,0,0,0.08); margin-bottom: 20px;
}
.invest-card.popx-card { border-color: var(--color-navy); }
.invest-card.gk-card { border-color: var(--color-pink); }
.invest-card.pool-card { border-color: var(--color-cyan); }
.invest-summary {
    background: linear-gradient(135deg, #059669, #047857);
    color: white; border-radius: 16px; padding: 28px; text-align: center; margin: 20px 0;
}
.invest-summary h3 { font-family: var(--font-heading); font-size: 12px; letter-spacing: 0.1em; opacity: 0.8; margin-bottom: 12px; }
.invest-summary .big-num { font-family: var(--font-heading); font-size: 36px; font-weight: 800; }
.invest-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 20px; }
.invest-grid-item { text-align: center; }
.invest-grid-item .ig-val { font-family: var(--font-heading); font-size: 20px; font-weight: 700; }
.invest-grid-item .ig-label { font-size: 11px; opacity: 0.7; margin-top: 2px; }
.recovery-bar-bg {
    background: #e5e7eb; border-radius: 8px; height: 24px; overflow: hidden; margin: 8px 0;
}
.recovery-bar-fill {
    background: linear-gradient(90deg, var(--color-cyan), #059669);
    height: 100%; border-radius: 8px; transition: width 0.4s ease;
    display: flex; align-items: center; justify-content: center;
    font-size: 10px; font-weight: 700; color: white; font-family: var(--font-heading);
}
</style>
</head>
<body>

<header>
    <a href="./08_POPX_Coffee_Hub.html" class="hub-link">&larr; Hub</a>
    <h1>BUSINESS STRUCTURE</h1>
    <p>popx coffee lab &times; greekee &mdash; Partnership Model</p>
</header>

<div class="container">

    <div class="tab-bar">
        <button class="tab-btn active" onclick="showTab('structure')">Business Structure</button>
        <button class="tab-btn" onclick="showTab('simulation')">S1 Revenue Sim</button>
        <button class="tab-btn" onclick="showTab('yearly')">12-Month Forecast</button>
        <button class="tab-btn" onclick="showTab('recovery')">S2 Investment &amp; Recovery</button>
    </div>

    <!-- ==================== TAB 1: BUSINESS STRUCTURE ==================== -->
    <div class="tab-panel active" id="tab-structure">

        <div class="section-title">Partnership Overview</div>

        <div class="card-grid">
            <div class="card">
                <h3>POPX Inc.</h3>
                <div class="cost-row"><span class="cost-label">Role</span><span class="cost-value">äº‹æ¥­é‹å–¶ãƒ»ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–</span></div>
                <div class="cost-row"><span class="cost-label">äº‹æ¥­å½¢æ…‹</span><span class="cost-value">POPXåˆ¥äº‹æ¥­éƒ¨</span></div>
                <div class="cost-row"><span class="cost-label">æ‹…å½“é ˜åŸŸ</span><span class="cost-value">ã‚³ãƒ¼ãƒ’ãƒ¼äº‹æ¥­å…¨èˆ¬</span></div>
                <div class="cost-row"><span class="cost-label">ã‚°ãƒƒã‚ºåˆ¶ä½œ</span><span class="cost-value">vanitystoreå®Ÿç¸¾ã‚ã‚Š</span></div>
                <div class="cost-row"><span class="cost-label">ãƒã‚¤ã‚¨ãƒ³ãƒ‰å§”è¨—</span><span class="cost-value">pattythreeï¼ˆå–ç· å½¹é–¢é€£ä¼šç¤¾ï¼‰</span></div>
                <div class="cost-row"><span class="cost-label">æŠ•è³‡</span><span class="cost-value">æ©Ÿæãƒ»è±†ä»•å…¥ã‚Œç«‹æ›¿</span></div>
            </div>
            <div class="card">
                <h3>greekee</h3>
                <div class="cost-row"><span class="cost-label">Role</span><span class="cost-value">IPæä¾›ãƒ»å ´æ‰€æä¾›</span></div>
                <div class="cost-row"><span class="cost-label">æ³•çš„é–¢ä¿‚</span><span class="cost-value">åˆ¥æ³•äºº</span></div>
                <div class="cost-row"><span class="cost-label">IPæ‰€æœ‰</span><span class="cost-value">ã‚°ãƒ¼ã‚°ãƒ¼ï¼†ãƒªãƒª</span></div>
                <div class="cost-row"><span class="cost-label">å ´æ‰€æä¾›</span><span class="cost-value">ä¸­ç›®é»’åº—èˆ—ã®é–“å€Ÿã‚Š</span></div>
                <div class="cost-row"><span class="cost-label">ãƒãƒªã‚¹ã‚¿</span><span class="cost-value">é›‡ç”¨ãƒ»å¥‘ç´„ç®¡ç†</span></div>
                <div class="cost-row"><span class="cost-label">ã‚³ã‚¹ãƒˆè² æ‹…</span><span class="cost-value">ãƒãƒªã‚¹ã‚¿äººä»¶è²»ï¼ˆæ¥­å‹™å§”è¨—ï¼‰</span></div>
            </div>
        </div>

        <!-- Revenue Flow - Updated for S1 Pool -->
        <div class="section-title">S1 Revenue Flowï¼ˆé–“å€Ÿã‚Šãƒ•ã‚§ãƒ¼ã‚ºï¼‰</div>

        <div class="flow-container">
            <h3 style="font-family:var(--font-heading);font-size:13px;font-weight:700;color:var(--color-navy);letter-spacing:0.08em;text-transform:uppercase;margin-bottom:16px;">Revenue &rarr; Top-off &rarr; Profit &rarr; S2 Pool</h3>
            <div class="flow-diagram">
                <div class="flow-box flow-revenue">å£²ä¸Š<br><small>ã‚«ãƒ•ã‚§ / ã‚°ãƒƒã‚º</small></div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-box flow-topoff">ãƒˆãƒƒãƒ—ã‚ªãƒ•<br><small>å…±é€šäº‹æ¥­ã‚³ã‚¹ãƒˆ</small></div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-box flow-profit">äº‹æ¥­åˆ©ç›Š<br><small>Gross Profit</small></div>
                <div class="flow-arrow">&rarr;</div>
                <div class="flow-box flow-pool">S2ãƒ—ãƒ¼ãƒ«<br><small>å…¨é¡ãƒ—ãƒ¼ãƒ«</small></div>
                <div class="flow-arrow">&rarr;</div>
                <div style="display:flex;flex-direction:column;gap:8px;">
                    <div class="flow-box flow-popx" style="font-size:11px;">POPX<br><small>è±†åŸä¾¡+ãã®ä»–åŸä¾¡<br>ï¼ˆãƒˆãƒƒãƒ—ã‚ªãƒ•çµŒç”±ï¼‰</small></div>
                    <div class="flow-box flow-greekee" style="font-size:11px;">greekee<br><small>å›ºå®šåå…¥ã®ã¿<br>ï¼ˆå®¶è³ƒãƒ»ãƒãƒªã‚¹ã‚¿ï¼‰</small></div>
                </div>
            </div>
        </div>

        <div class="note-box">
            <strong>S1ãƒ•ã‚§ãƒ¼ã‚ºæ–¹é‡ï¼š</strong>äº‹æ¥­åˆ©ç›Šã¯å…¨é¡S2æŠ•è³‡ãƒ—ãƒ¼ãƒ«ã¸ã€‚POPXã¯è±†åŸä¾¡+ãã®ä»–åŸä¾¡ï¼ˆcafeCogsï¼‰ã‚’ãƒˆãƒƒãƒ—ã‚ªãƒ•çµŒç”±ã§å›åã€‚greekeeã¯å®¶è³ƒãƒ»ãƒãƒªã‚¹ã‚¿æ¥­å‹™å§”è¨—è²»ã‚’ãƒˆãƒƒãƒ—ã‚ªãƒ•ã§å—é ˜ã€‚ãƒ¬ãƒ™ãƒ‹ãƒ¥ãƒ¼ã‚·ã‚§ã‚¢ã«ã‚ˆã‚‹åˆ†é…ã¯S2ä»¥é™ã«é–‹å§‹ã€‚
        </div>

        <!-- Top-off items -->
        <div class="card">
            <h3>ãƒˆãƒƒãƒ—ã‚ªãƒ•é …ç›®ï¼ˆå£²ä¸Šã‹ã‚‰æ§é™¤ï¼‰</h3>
            <table class="struct-table">
                <thead><tr><th>é …ç›®</th><th>å†…å®¹</th><th>è² æ‹…è€…</th><th>Status</th></tr></thead>
                <tbody>
                    <tr><td>ã‚³ãƒ¼ãƒ’ãƒ¼è±†ä»•å…¥ã‚Œ</td><td>COGS â€” ä»•å…¥ã‚Œä¼ç¥¨ãƒ™ãƒ¼ã‚¹</td><td>POPXç«‹æ›¿</td><td><span class="badge badge-shared">TOP-OFF</span></td></tr>
                    <tr><td>ã‚°ãƒƒã‚ºè£½é€ è²»</td><td>COGS â€” è£½é€ ç™ºæ³¨æ›¸ãƒ™ãƒ¼ã‚¹</td><td>ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹</td><td><span class="badge badge-shared">TOP-OFF</span></td></tr>
                    <tr><td>å®¶è³ƒ</td><td>greekeeã¸ã®æœˆé¡å›ºå®šæ”¯æ‰•ã„</td><td>å£²ä¸Šã‹ã‚‰æ§é™¤</td><td><span class="badge badge-shared">TOP-OFF</span></td></tr>
                    <tr><td>ãƒãƒªã‚¹ã‚¿æ¥­å‹™å§”è¨—è²»</td><td>greekeeé›‡ç”¨ â†’ POPXã¸æœˆé¡è«‹æ±‚</td><td>greekeeé›‡ç”¨</td><td><span class="badge badge-shared">TOP-OFF</span></td></tr>
                    <tr><td>æ¶ˆè€—å“ãƒ»æ‰‹æ•°æ–™</td><td>ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã€ã‚«ãƒƒãƒ—ã€ECæ‰‹æ•°æ–™ç­‰</td><td>ä¼ç¥¨ãƒ™ãƒ¼ã‚¹</td><td><span class="badge badge-shared">TOP-OFF</span></td></tr>
                    <tr><td style="color:#999;">æ©Ÿæï¼ˆè¨­å‚™æŠ•è³‡ï¼‰</td><td style="color:#999;">ã‚¨ã‚¹ãƒ—ãƒ¬ãƒƒã‚½ãƒã‚·ãƒ³ã€ã‚°ãƒ©ã‚¤ãƒ³ãƒ€ãƒ¼ç­‰</td><td style="color:#999;">POPXæŠ•è³‡</td><td><span class="badge badge-popx">POPXè² æ‹…</span></td></tr>
                </tbody>
            </table>
        </div>

        <!-- Revenue Split - Interactive -->
        <div class="section-title">Revenue Splitï¼ˆS2ä»¥é™é©ç”¨ï¼‰<span style="font-size:10px;font-weight:400;text-transform:none;letter-spacing:0;margin-left:12px;color:#999;">ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã§èª¿æ•´ â†’ S1 Sim / S2 Recovery ã«å³æ™‚åæ˜ </span></div>

        <div class="note-box" style="margin-bottom: 20px; background: #fef3c7; border-color: #f59e0b;">
            <strong>S1ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯åˆ†é…ãªã—ï¼š</strong>ä¸‹è¨˜ã®åˆ†é…æ¯”ç‡ã¯S2ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆ1åº—èˆ—ç›®é–‹æ¥­å¾Œï¼‰ã‹ã‚‰é©ç”¨ã€‚S1ã§ã¯å…¨é¡ãƒ—ãƒ¼ãƒ«ã¨ãªã‚‹ãŸã‚ã€ã“ã®æ¯”ç‡ã¯ã€Œæœ¬æ¥ã®åˆ†é…é¡ã€ã¨ã—ã¦å‚è€ƒè¡¨ç¤ºã®ã¿ã€‚<br><strong>greekeeã‚ªãƒ¼ãƒŠãƒ¼ã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§äº¤æ¸‰ã—ãªãŒã‚‰æ¯”ç‡ã‚’èª¿æ•´ã§ãã¾ã™ã€‚</strong>
        </div>

        <div class="card">
            <h3>ã‚«ãƒ•ã‚§äº‹æ¥­åˆ©ç›Š â€” POPX / greekee åˆ†é…</h3>
            <div class="control-group" style="margin-bottom:8px;">
                <div class="control-label"><span>POPX å–ã‚Šåˆ†</span><span class="control-val" id="v-t1-cafe-popx">80%</span></div>
                <input type="range" id="s-t1-cafe-popx" min="0" max="100" step="5" value="80" oninput="syncSplitFromTab1()">
            </div>
            <div class="split-bar-container">
                <div class="split-bar">
                    <div class="split-popx" id="bar-t1-cafe-popx" style="width:80%">POPX 80%</div>
                    <div class="split-greekee" id="bar-t1-cafe-gk" style="width:20%">greekee 20%</div>
                </div>
                <div class="split-label"><span>äº‹æ¥­é‹å–¶ãƒ»æŠ•è³‡ãƒ»ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–</span><span>å ´æ‰€æä¾›ãƒ»ä¸–ç•Œè¦³</span></div>
            </div>
        </div>

        <div class="card">
            <h3>ã‚°ãƒƒã‚ºäº‹æ¥­åˆ©ç›Š â€” POPX / greekee åˆ†é…</h3>
            <div class="control-group" style="margin-bottom:8px;">
                <div class="control-label"><span>POPX å–ã‚Šåˆ†</span><span class="control-val" id="v-t1-goods-popx">20%</span></div>
                <input type="range" id="s-t1-goods-popx" min="0" max="100" step="5" value="20" oninput="syncSplitFromTab1()">
            </div>
            <div class="split-bar-container">
                <div class="split-bar">
                    <div class="split-popx" id="bar-t1-goods-popx" style="width:20%">POPX 20%</div>
                    <div class="split-greekee" id="bar-t1-goods-gk" style="width:80%">greekee 80%</div>
                </div>
                <div class="split-label"><span>ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ– / è£½é€  / è²©å£²</span><span>IP / ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</span></div>
            </div>
        </div>

        <div class="note-box" style="margin-top:20px;">
            <strong>å››åŠæœŸP&Lãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼š</strong>POPXãƒ»greekeeä¸¡ç¤¾ã§å››åŠæœŸã”ã¨ã«P&Lãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½ã€‚ãƒˆãƒƒãƒ—ã‚ªãƒ•é …ç›®ã®é©æ­£æ€§ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦èª¿æ•´ã€‚
        </div>

    </div>

    <!-- ==================== TAB 2: S1 SIMULATION ==================== -->
    <div class="tab-panel" id="tab-simulation">

        <div class="section-title">S1 é–“å€Ÿã‚Šãƒ¢ãƒ‡ãƒ« â€” Revenue Simulation</div>

        <div class="note-box">
            <strong>S1ãƒ•ã‚§ãƒ¼ã‚ºï¼š</strong>greekeeä¸­ç›®é»’åº—èˆ—å†…ã§ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—å‹ã‚«ãƒ•ã‚§é‹å–¶ã€‚äº‹æ¥­åˆ©ç›Šã¯<strong>å…¨é¡S2ãƒ—ãƒ¼ãƒ«</strong>ã€‚POPXã¯è±†åŸä¾¡+ãã®ä»–åŸä¾¡ï¼ˆcafeCogsï¼‰ã‚’ãƒˆãƒƒãƒ—ã‚ªãƒ•çµŒç”±ã§å›åã€‚
        </div>

        <div class="card-grid">
            <div class="card">
                <h3>â˜• ã‚«ãƒ•ã‚§ â€” ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</h3>
                <div class="control-group">
                    <div class="control-label"><span>å–¶æ¥­æ—¥æ•° / æœˆ</span><span class="control-val" id="v-days">20</span></div>
                    <input type="range" id="s-days" min="8" max="28" value="20" oninput="simulate()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>1æ—¥ã‚ãŸã‚Šæ¯æ•°</span><span class="control-val" id="v-cups">18</span></div>
                    <input type="range" id="s-cups" min="5" max="40" value="18" oninput="simulate()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>å¹³å‡å˜ä¾¡ï¼ˆã‚³ãƒ¼ãƒ’ãƒ¼ï¼‰</span><span class="control-val" id="v-price">Â¥1,800</span></div>
                    <input type="range" id="s-price" min="800" max="4000" step="100" value="1800" oninput="simulate()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>è±†åŸä¾¡ / æ¯</span><span class="control-val" id="v-bean">Â¥450</span></div>
                    <input type="range" id="s-bean" min="200" max="900" step="10" value="450" oninput="simulate()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>ãã®ä»–åŸä¾¡ / æ¯ï¼ˆæ°´ãƒ»ã‚«ãƒƒãƒ—ç­‰ï¼‰</span><span class="control-val" id="v-other">Â¥50</span></div>
                    <input type="range" id="s-other" min="20" max="150" step="10" value="50" oninput="simulate()">
                </div>
            </div>

            <div class="card">
                <h3>ğŸ  å›ºå®šã‚³ã‚¹ãƒˆï¼ˆãƒˆãƒƒãƒ—ã‚ªãƒ•ï¼‰</h3>
                <div class="control-group">
                    <div class="control-label"><span>å®¶è³ƒï¼ˆgreekeeã¸æœˆé¡å›ºå®šï¼‰</span><span class="control-val" id="v-rent">Â¥80,000</span></div>
                    <input type="range" id="s-rent" min="30000" max="200000" step="5000" value="80000" oninput="simulate()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>ãƒãƒªã‚¹ã‚¿æ¥­å‹™å§”è¨—è²» / æœˆ</span><span class="control-val" id="v-barista">Â¥120,000</span></div>
                    <input type="range" id="s-barista" min="50000" max="300000" step="5000" value="120000" oninput="simulate()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>æ¶ˆè€—å“ãƒ»é›‘è²» / æœˆ</span><span class="control-val" id="v-misc">Â¥30,000</span></div>
                    <input type="range" id="s-misc" min="10000" max="80000" step="5000" value="30000" oninput="simulate()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>é€æ–™ãƒ»é–¢ç¨ / æœˆ</span><span class="control-val" id="v-shipping">Â¥20,000</span></div>
                    <input type="range" id="s-shipping" min="5000" max="50000" step="5000" value="20000" oninput="simulate()">
                </div>
            </div>
        </div>

        <!-- Goods Parameters -->
        <div class="card">
            <h3>ğŸ ã‚°ãƒƒã‚ºäº‹æ¥­ â€” ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</h3>
            <div class="card-grid" style="margin-bottom:0;">
                <div>
                    <div class="control-group">
                        <div class="control-label"><span>ã‚°ãƒƒã‚ºæœˆé–“å£²ä¸Š</span><span class="control-val" id="v-goods-rev">Â¥200,000</span></div>
                        <input type="range" id="s-goods-rev" min="0" max="1000000" step="10000" value="200000" oninput="simulate()">
                    </div>
                    <div class="control-group">
                        <div class="control-label"><span>ã‚°ãƒƒã‚ºåŸä¾¡ç‡</span><span class="control-val" id="v-goods-cogs">35%</span></div>
                        <input type="range" id="s-goods-cogs" min="15" max="60" value="35" oninput="simulate()">
                    </div>
                </div>
                <div>
                    <div class="note-box" style="margin:0;font-size:12px;">
                        ã‚°ãƒƒã‚ºåˆ†é…æ¯”ç‡ã¯ä¸‹ã®ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã§èª¿æ•´å¯èƒ½ã€‚ã‚°ãƒƒã‚ºé‹å–¶ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¿œã˜ã¦POPX/greekeeæ¯”ç‡ã‚’å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚
                    </div>
                </div>
            </div>
        </div>

        <!-- Revenue Share Sliders -->
        <div class="card">
            <h3>ğŸ“Š S1 ãƒ¬ãƒ™ãƒ‹ãƒ¥ãƒ¼ã‚·ã‚§ã‚¢æ¯”ç‡ï¼ˆPOPX / greekeeï¼‰</h3>
            <div class="note-box" style="margin:0 0 16px 0; font-size:12px;">
                S1ã§ã¯å…¨é¡ãƒ—ãƒ¼ãƒ«ã®ãŸã‚å‚è€ƒå€¤ã€‚greekeeã‚ªãƒ¼ãƒŠãƒ¼ã¨ã®äº¤æ¸‰ãƒ™ãƒ¼ã‚¹ã§èª¿æ•´å¯èƒ½ã€‚
            </div>
            <div class="card-grid" style="margin-bottom:0;">
                <div>
                    <div class="control-group">
                        <div class="control-label"><span>ã‚«ãƒ•ã‚§åˆ©ç›Š POPXå–ã‚Šåˆ†</span><span class="control-val" id="v-s1-cafe-popx">80%</span></div>
                        <input type="range" id="s-s1-cafe-popx" min="0" max="100" step="5" value="80" oninput="syncSplitFromS1()">
                    </div>
                    <div class="split-bar-container">
                        <div class="split-bar">
                            <div class="split-popx" id="bar-s1-cafe-popx" style="width:80%">POPX 80%</div>
                            <div class="split-greekee" id="bar-s1-cafe-gk" style="width:20%">greekee 20%</div>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="control-group">
                        <div class="control-label"><span>ã‚°ãƒƒã‚ºåˆ©ç›Š POPXå–ã‚Šåˆ†</span><span class="control-val" id="v-s1-goods-popx">20%</span></div>
                        <input type="range" id="s-s1-goods-popx" min="0" max="100" step="5" value="20" oninput="syncSplitFromS1()">
                    </div>
                    <div class="split-bar-container">
                        <div class="split-bar">
                            <div class="split-popx" id="bar-s1-goods-popx" style="width:20%">POPX 20%</div>
                            <div class="split-greekee" id="bar-s1-goods-gk" style="width:80%">greekee 80%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RESULTS BANNER -->
        <div class="result-banner" id="result-banner">
            <h2>MONTHLY BUSINESS PROFIT</h2>
            <div class="result-big positive" id="r-total">Â¥0</div>
            <div class="result-sub">ã‚«ãƒ•ã‚§ + ã‚°ãƒƒã‚º åˆè¨ˆäº‹æ¥­åˆ©ç›Š â†’ <strong>å…¨é¡S2ãƒ—ãƒ¼ãƒ«</strong></div>
            <div class="result-grid">
                <div class="result-item">
                    <div class="ri-val" id="r-cafe-profit" style="color:var(--color-cyan)">Â¥0</div>
                    <div class="ri-label">ã‚«ãƒ•ã‚§äº‹æ¥­åˆ©ç›Š</div>
                </div>
                <div class="result-item">
                    <div class="ri-val" id="r-goods-profit" style="color:var(--color-pink)">Â¥0</div>
                    <div class="ri-label">ã‚°ãƒƒã‚ºäº‹æ¥­åˆ©ç›Š</div>
                </div>
            </div>
        </div>

        <!-- S1 Split: Pool + Actual Income -->
        <div class="scenario-grid">
            <div class="card" style="position:relative;">
                <h3 style="color:var(--color-navy);">POPX â€” S1 æœˆé–“åç›Š</h3>
                <div class="split-card" style="background:#fef3c7; position:relative;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                        <div class="split-card-label">æœ¬æ¥ã®åˆ†é…é¡ï¼ˆå‚è€ƒï¼‰</div>
                        <span class="badge-s2-pool">S2 ãƒ—ãƒ¼ãƒ«ä¸­</span>
                    </div>
                    <div class="split-card-formula" id="f-popx-cafe-formula">å¼</div>
                    <div class="pooled-amount" id="r-popx-cafe-pooled">Â¥0</div>
                    <div style="height:8px;"></div>
                    <div class="split-card-formula" id="f-popx-goods-formula">å¼</div>
                    <div class="pooled-amount" id="r-popx-goods-pooled">Â¥0</div>
                    <div style="height:4px;"></div>
                    <div class="pooled-amount" id="r-popx-total-pooled">åˆè¨ˆ: Â¥0</div>
                </div>
                <div class="split-card" style="background:#e8f5e9; border: 2px solid #059669;">
                    <div class="split-card-label" style="color:#059669;">å®Ÿéš›ã®å—å–é¡ï¼ˆS1ãƒ•ã‚§ãƒ¼ã‚ºï¼‰</div>
                    <div class="split-card-formula" id="f-popx-actual-formula">è±†åŸä¾¡ + ãã®ä»–åŸä¾¡ï¼ˆãƒˆãƒƒãƒ—ã‚ªãƒ•çµŒç”±ã§å›åï¼‰</div>
                    <div class="actual-amount" id="r-popx-actual">Â¥0</div>
                </div>
            </div>
            <div class="card" style="position:relative;">
                <h3 style="color:var(--color-pink);">greekee â€” S1 æœˆé–“åç›Š</h3>
                <div class="split-card" style="background:#fef3c7; position:relative;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                        <div class="split-card-label">æœ¬æ¥ã®åˆ†é…é¡ï¼ˆå‚è€ƒï¼‰</div>
                        <span class="badge-s2-pool">S2 ãƒ—ãƒ¼ãƒ«ä¸­</span>
                    </div>
                    <div class="split-card-formula" id="f-gk-cafe-formula">å¼</div>
                    <div class="pooled-amount" id="r-gk-cafe-pooled">Â¥0</div>
                    <div style="height:8px;"></div>
                    <div class="split-card-formula" id="f-gk-goods-formula">å¼</div>
                    <div class="pooled-amount" id="r-gk-goods-pooled">Â¥0</div>
                    <div style="height:4px;"></div>
                    <div class="pooled-amount" id="r-gk-total-pooled">åˆè¨ˆ: Â¥0</div>
                </div>
                <div class="split-card" style="background:#e8f5e9; border: 2px solid #059669;">
                    <div class="split-card-label" style="color:#059669;">å®Ÿéš›ã®å—å–é¡ï¼ˆS1ãƒ•ã‚§ãƒ¼ã‚ºï¼‰</div>
                    <div style="font-size:12px; color:#666; margin-bottom:4px;">å›ºå®šåå…¥ï¼ˆãƒˆãƒƒãƒ—ã‚ªãƒ•çµŒç”±ï¼‰</div>
                    <div class="cost-row" style="padding:4px 0;"><span class="cost-label">å®¶è³ƒåå…¥</span><span class="cost-value" id="r-gk-rent">Â¥0</span></div>
                    <div class="cost-row" style="padding:4px 0;"><span class="cost-label">ãƒãƒªã‚¹ã‚¿æ¥­å‹™å§”è¨—åå…¥</span><span class="cost-value" id="r-gk-barista">Â¥0</span></div>
                    <div style="border-top:1px solid #059669;padding-top:8px;margin-top:8px;">
                        <div class="actual-amount" id="r-gk-actual">Â¥200,000</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- S2 Pool Banner -->
        <div style="background:linear-gradient(135deg,#f59e0b,#d97706);color:white;border-radius:16px;padding:28px;text-align:center;margin:20px 0;">
            <h3 style="font-family:var(--font-heading);font-size:12px;letter-spacing:0.1em;opacity:0.9;margin-bottom:8px;">S2 INVESTMENT POOLï¼ˆæœˆé¡ãƒ—ãƒ¼ãƒ«é¡ï¼‰</h3>
            <div style="font-family:var(--font-heading);font-size:36px;font-weight:800;" id="r-s2-pool-amount">Â¥0</div>
            <div style="font-size:13px;opacity:0.8;margin-top:8px;" id="r-s2-pool-formula">äº‹æ¥­åˆ©ç›Š Â¥0 â†’ å…¨é¡S2ãƒ—ãƒ¼ãƒ«</div>
        </div>

        <!-- P&L Waterfall -->
        <div class="card">
            <h3>P&L Waterfallï¼ˆæœˆæ¬¡ï¼‰</h3>
            <div class="cost-row"><span class="cost-label">ã‚«ãƒ•ã‚§å£²ä¸Š</span><span class="cost-value" id="w-cafe-rev">Â¥0</span></div>
            <div class="cost-row"><span class="cost-label">ã€€â”” è±†åŸä¾¡ + ãã®ä»–åŸä¾¡</span><span class="cost-value red" id="w-cafe-cogs">-Â¥0</span></div>
            <div class="cost-row"><span class="cost-label">ã€€â”” å®¶è³ƒï¼ˆgreekeeï¼‰</span><span class="cost-value red" id="w-rent">-Â¥0</span></div>
            <div class="cost-row"><span class="cost-label">ã€€â”” ãƒãƒªã‚¹ã‚¿æ¥­å‹™å§”è¨—è²»</span><span class="cost-value red" id="w-barista">-Â¥0</span></div>
            <div class="cost-row"><span class="cost-label">ã€€â”” æ¶ˆè€—å“ãƒ»é›‘è²»</span><span class="cost-value red" id="w-misc">-Â¥0</span></div>
            <div class="cost-row"><span class="cost-label">ã€€â”” é€æ–™ãƒ»é–¢ç¨</span><span class="cost-value red" id="w-shipping">-Â¥0</span></div>
            <div class="cost-row" style="border-top:2px solid var(--color-navy);padding-top:12px;margin-top:4px;"><span class="cost-label" style="font-weight:700;">ã‚«ãƒ•ã‚§äº‹æ¥­åˆ©ç›Š</span><span class="cost-value" id="w-cafe-profit" style="font-size:16px;">Â¥0</span></div>
            <div style="height:16px;"></div>
            <div class="cost-row"><span class="cost-label">ã‚°ãƒƒã‚ºå£²ä¸Š</span><span class="cost-value" id="w-goods-rev">Â¥0</span></div>
            <div class="cost-row"><span class="cost-label">ã€€â”” ã‚°ãƒƒã‚ºåŸä¾¡</span><span class="cost-value red" id="w-goods-cogs">-Â¥0</span></div>
            <div class="cost-row" style="border-top:2px solid var(--color-navy);padding-top:12px;margin-top:4px;"><span class="cost-label" style="font-weight:700;">ã‚°ãƒƒã‚ºäº‹æ¥­åˆ©ç›Š</span><span class="cost-value" id="w-goods-profit" style="font-size:16px;">Â¥0</span></div>
            <div class="cost-total">
                <div class="cost-row"><span class="cost-label">åˆè¨ˆäº‹æ¥­åˆ©ç›Š</span><span class="cost-value" id="w-total" style="font-size:20px;">Â¥0</span></div>
            </div>
            <div style="height:12px;"></div>
            <div style="padding: 16px; background: linear-gradient(135deg, #fef3c7, #fde68a); border-radius: 12px; margin-top: 12px;">
                <div class="cost-row" style="border:none;font-size:18px;"><span class="cost-label" style="font-weight:800;color:#92400e;">= S2ãƒ—ãƒ¼ãƒ«é¡ï¼ˆå…¨é¡ï¼‰</span><span class="cost-value" style="color:#92400e;font-size:20px;" id="w-s2-pool">Â¥0</span></div>
                <div class="cost-row" style="border:none;font-size:12px;"><span class="cost-label" style="color:#92400e;">â€» POPXå›å = è±†åŸä¾¡+ãã®ä»–åŸä¾¡ï¼ˆãƒˆãƒƒãƒ—ã‚ªãƒ•çµŒç”±ï¼‰</span><span class="cost-value" style="color:#92400e;" id="w-popx-cogs-note">Â¥0</span></div>
            </div>
        </div>

    </div>

    <!-- ==================== TAB 3: 12-MONTH FORECAST ==================== -->
    <div class="tab-panel" id="tab-yearly">

        <div class="section-title">S1 12-Month Forecast â€” S2 Fund Accumulation</div>

        <div class="note-box">
            S1ãƒ•ã‚§ãƒ¼ã‚º12ãƒ¶æœˆã®æˆé•·äºˆæ¸¬ã€‚äº‹æ¥­åˆ©ç›Šã¯å…¨é¡S2ãƒ—ãƒ¼ãƒ«ã€‚POPXã¯è±†åŸä¾¡+ãã®ä»–åŸä¾¡ã‚’ãƒˆãƒƒãƒ—ã‚ªãƒ•çµŒç”±ã§å›åã€‚
        </div>

        <div class="card-grid">
            <div class="card">
                <h3>ğŸ“ˆ æˆé•·ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</h3>
                <div class="control-group">
                    <div class="control-label"><span>ã‚«ãƒ•ã‚§æ¯æ•° æœˆæ¬¡æˆé•·ç‡</span><span class="control-val" id="v-cafe-growth">5%</span></div>
                    <input type="range" id="s-cafe-growth" min="0" max="20" value="5" oninput="forecast()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>ã‚°ãƒƒã‚ºå£²ä¸Š æœˆæ¬¡æˆé•·ç‡</span><span class="control-val" id="v-goods-growth">8%</span></div>
                    <input type="range" id="s-goods-growth" min="0" max="30" value="8" oninput="forecast()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>ã‚«ãƒ•ã‚§æ¯æ•°ä¸Šé™ / æ—¥</span><span class="control-val" id="v-cups-cap">30</span></div>
                    <input type="range" id="s-cups-cap" min="15" max="50" value="30" oninput="forecast()">
                </div>
            </div>
            <div class="card">
                <h3>ğŸ¯ S2 Investment Target</h3>
                <div class="control-group">
                    <div class="control-label"><span>S2ç›®æ¨™é‡‘é¡</span><span class="control-val" id="v-s2-target">Â¥25,000,000</span></div>
                    <input type="range" id="s-s2-target" min="15000000" max="40000000" step="1000000" value="25000000" oninput="forecast()">
                </div>
                <div class="note-box" style="margin:8px 0 0 0; font-size:12px;">
                    S1ãƒ—ãƒ¼ãƒ«ã ã‘ã§ã¯åˆ°é”ä¸å¯èƒ½ â†’ S2æŠ•è³‡ã‚¿ãƒ–ã§ POPXãƒ»greekeeæœ¬ä½“ã®æŠ•è³‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                </div>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ“Š Year 1 Summary</h3>
            <div class="stat-row">
                <div class="stat-box">
                    <div class="stat-num" id="y-total-rev">â€”</div>
                    <div class="stat-label">å¹´é–“ç·å£²ä¸Š</div>
                </div>
                <div class="stat-box">
                    <div class="stat-num" id="y-total-profit">â€”</div>
                    <div class="stat-label">å¹´é–“äº‹æ¥­åˆ©ç›Š</div>
                </div>
                <div class="stat-box">
                    <div class="stat-num" id="y-s2-accumulated">â€”</div>
                    <div class="stat-label">S2 Fund ç´¯ç©</div>
                </div>
                <div class="stat-box">
                    <div class="stat-num" id="y-gap-to-s2">â€”</div>
                    <div class="stat-label">S2 ä¸è¶³é¡ï¼ˆè¦æŠ•è³‡ï¼‰</div>
                </div>
            </div>
        </div>

        <div class="card" style="overflow-x:auto;">
            <h3>Monthly Breakdown</h3>
            <table class="monthly-table" id="forecast-table">
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>æ¯æ•°/æ—¥</th>
                        <th>ã‚«ãƒ•ã‚§å£²ä¸Š</th>
                        <th>ã‚°ãƒƒã‚ºå£²ä¸Š</th>
                        <th>äº‹æ¥­åˆ©ç›Š</th>
                        <th>POPX(cafeCogs)</th>
                        <th>S2 Pool</th>
                        <th>S2 ç´¯ç©</th>
                    </tr>
                </thead>
                <tbody id="forecast-body"></tbody>
            </table>
        </div>

    </div>

    <!-- ==================== TAB 4: S2 INVESTMENT & RECOVERY ==================== -->
    <div class="tab-panel" id="tab-recovery">

        <div class="section-title">S2 Investment & Recovery Simulation</div>

        <div class="note-box">
            S1ãƒ—ãƒ¼ãƒ«ã ã‘ã§ã¯S2ï¼ˆÂ¥2,000ã€œ3,000ä¸‡ï¼‰ã«åˆ°é”ä¸å¯ã€‚POPXæœ¬ä½“ãƒ»greekeeæœ¬ä½“ã‹ã‚‰ã®<strong>ç›´æ¥æŠ•è³‡</strong>ã‚’åŠ ãˆãŸç·åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚
        </div>

        <!-- Phase Overview -->
        <div class="phase-timeline">
            <div class="phase-box s1">
                <h4>S1: é–“å€Ÿã‚Šé‹å–¶</h4>
                <p>
                    <strong>ç›®çš„ï¼š</strong>äº‹æ¥­æ¤œè¨¼ãƒ»ãƒ—ãƒ¼ãƒ«<br>
                    <strong>åˆ©ç›Šï¼š</strong>å…¨é¡S2ãƒ—ãƒ¼ãƒ«<br>
                    <strong>POPXï¼š</strong>cafeCogså›åï¼ˆTOP-OFFï¼‰
                </p>
            </div>
            <div class="phase-arrow">&rarr;</div>
            <div class="phase-box s2">
                <h4>S2: 1åº—èˆ—ç›®</h4>
                <p>
                    <strong>æŠ•è³‡ï¼š</strong>S1ãƒ—ãƒ¼ãƒ« + æœ¬ä½“æŠ•è³‡<br>
                    <strong>ç›®æ¨™ï¼š</strong>æŠ•è³‡å›å<br>
                    <strong>åˆ†é…ï¼š</strong>ãƒ¬ãƒ™ãƒ‹ãƒ¥ãƒ¼ã‚·ã‚§ã‚¢é–‹å§‹
                </p>
            </div>
            <div class="phase-arrow">&rarr;</div>
            <div class="phase-box s3">
                <h4>S3: 2åº—èˆ—ç›®</h4>
                <p>
                    <strong>ä½“åˆ¶ï¼š</strong>é‹ç”¨ãƒ•ã‚§ãƒ¼ã‚º<br>
                    <strong>å±•é–‹ï¼š</strong>S2ãƒã‚¦ãƒã‚¦ã‚’æ‹¡å¼µ<br>
                    <strong>ç›®æ¨™ï¼š</strong>å®‰å®šåˆ©ç›ŠåŒ–
                </p>
            </div>
        </div>

        <!-- Investment Parameters -->
        <div class="card-grid">
            <div class="invest-card pool-card">
                <h3 style="color:#92400e;">ğŸ’° S1 ãƒ—ãƒ¼ãƒ«ï¼ˆè‡ªå‹•è¨ˆç®—ï¼‰</h3>
                <div class="control-group">
                    <div class="control-label"><span>S1é‹å–¶æœŸé–“</span><span class="control-val" id="v-s1-months">12</span>ãƒ¶æœˆ</div>
                    <input type="range" id="s-s1-months" min="6" max="24" value="12" oninput="calcInvestment()">
                </div>
                <div style="background:#fef3c7;border-radius:8px;padding:12px;text-align:center;margin-top:8px;">
                    <div style="font-size:11px;color:#92400e;margin-bottom:4px;">S1ç´¯ç©ãƒ—ãƒ¼ãƒ«é¡</div>
                    <div style="font-family:var(--font-heading);font-size:28px;font-weight:800;color:#92400e;" id="inv-s1-pool">Â¥0</div>
                </div>
            </div>
            <div class="invest-card popx-card">
                <h3 style="color:var(--color-navy);">ğŸ¢ POPXæœ¬ä½“ æŠ•è³‡</h3>
                <div class="control-group">
                    <div class="control-label"><span>æŠ•è³‡é¡</span><span class="control-val" id="v-popx-invest">Â¥10,000,000</span></div>
                    <input type="range" id="s-popx-invest" min="0" max="25000000" step="500000" value="10000000" oninput="calcInvestment()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>æŠ•è³‡ã‚¿ã‚¤ãƒŸãƒ³ã‚°</span><span class="control-val" id="v-popx-invest-timing">S1çµ‚äº†æ™‚</span></div>
                    <input type="range" id="s-popx-invest-timing" min="6" max="24" value="12" oninput="calcInvestment()">
                </div>
            </div>
            <div class="invest-card gk-card">
                <h3 style="color:var(--color-pink);">ğŸ¢ greekeeæœ¬ä½“ æŠ•è³‡</h3>
                <div class="control-group">
                    <div class="control-label"><span>æŠ•è³‡é¡</span><span class="control-val" id="v-gk-invest">Â¥10,000,000</span></div>
                    <input type="range" id="s-gk-invest" min="0" max="25000000" step="500000" value="10000000" oninput="calcInvestment()">
                </div>
                <div class="control-group">
                    <div class="control-label"><span>æŠ•è³‡ã‚¿ã‚¤ãƒŸãƒ³ã‚°</span><span class="control-val" id="v-gk-invest-timing">S1çµ‚äº†æ™‚</span></div>
                    <input type="range" id="s-gk-invest-timing" min="6" max="24" value="12" oninput="calcInvestment()">
                </div>
            </div>
        </div>

        <!-- Total Investment Summary -->
        <div class="invest-summary" id="invest-summary">
            <h3>TOTAL S2 INVESTMENT</h3>
            <div class="big-num" id="inv-total">Â¥0</div>
            <div class="invest-grid">
                <div class="invest-grid-item">
                    <div class="ig-val" style="color:#fde68a;" id="inv-s1-pool-summary">Â¥0</div>
                    <div class="ig-label">S1 ãƒ—ãƒ¼ãƒ«</div>
                </div>
                <div class="invest-grid-item">
                    <div class="ig-val" style="color:white;" id="inv-popx-summary">Â¥0</div>
                    <div class="ig-label">POPXæœ¬ä½“</div>
                </div>
                <div class="invest-grid-item">
                    <div class="ig-val" style="color:var(--color-pink);" id="inv-gk-summary">Â¥0</div>
                    <div class="ig-label">greekeeæœ¬ä½“</div>
                </div>
            </div>
            <div style="margin-top:16px;font-size:13px;opacity:0.8;" id="inv-target-status">â€”</div>
        </div>

        <!-- S2 Recovery Simulation -->
        <div class="card">
            <h3>ğŸ“Š S2 åº—èˆ— â€” å£²ä¸Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ &amp; æŠ•è³‡å›å</h3>

            <div class="note-box" style="margin-bottom:20px;">
                <strong>S2åº—èˆ— â€” 2ãƒ¢ãƒ‡ãƒ«åˆ¶ï¼š</strong>POPãƒ¢ãƒ‡ãƒ«ï¼ˆã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ï¼‰ã¨BEAUTIFULãƒ¢ãƒ‡ãƒ«ï¼ˆãƒã‚¤ã‚¨ãƒ³ãƒ‰ï¼‰ã‚’ç‹¬ç«‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚å…±é€šã®å›ºå®šã‚³ã‚¹ãƒˆã‚’å·®ã—å¼•ã„ãŸåˆè¨ˆãŒæœˆé–“åˆ©ç›Šã€‚
            </div>

            <!-- POP Model -->
            <div class="card" style="border:2px solid var(--color-navy);">
                <h3>â˜• POP MODEL â€” ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ©ã‚¤ãƒ³ï¼ˆÂ¥1,200ã€œ6,000ï¼‰</h3>
                <div class="note-box" style="margin:0 0 12px;font-size:11px;">ãƒ‰ãƒªãƒƒãƒ—ãƒ»ãƒ©ãƒ†ãƒ»ã‚¨ã‚¹ãƒ—ãƒ¬ãƒƒã‚½ç³»ã€‚æ—¥å¸¸ä½¿ã„ã®å®¢å±¤ã€‚</div>
                <div class="card-grid" style="margin-bottom:0;">
                    <div>
                        <div class="control-group">
                            <div class="control-label"><span>1æ—¥ã‚ãŸã‚Šæ¯æ•°</span><span class="control-val" id="v-s2-pop-cups">40</span></div>
                            <input type="range" id="s-s2-pop-cups" min="10" max="120" value="40" oninput="calcInvestment()">
                        </div>
                        <div class="control-group">
                            <div class="control-label"><span>å¹³å‡å˜ä¾¡</span><span class="control-val" id="v-s2-pop-price">Â¥1,500</span></div>
                            <input type="range" id="s-s2-pop-price" min="1200" max="6000" step="100" value="1500" oninput="calcInvestment()">
                        </div>
                    </div>
                    <div>
                        <div class="control-group">
                            <div class="control-label"><span>è±†åŸä¾¡ / æ¯</span><span class="control-val" id="v-s2-pop-bean">Â¥350</span></div>
                            <input type="range" id="s-s2-pop-bean" min="150" max="800" step="10" value="350" oninput="calcInvestment()">
                        </div>
                        <div class="control-group">
                            <div class="control-label"><span>ãã®ä»–åŸä¾¡ / æ¯</span><span class="control-val" id="v-s2-pop-other">Â¥50</span></div>
                            <input type="range" id="s-s2-pop-other" min="20" max="200" step="10" value="50" oninput="calcInvestment()">
                        </div>
                    </div>
                </div>
                <div style="background:#f8f9fc;border-radius:8px;padding:10px 16px;margin-top:12px;display:flex;justify-content:space-between;align-items:center;">
                    <span style="font-size:12px;color:#666;">POPæœˆé–“å£²ä¸Š</span>
                    <span style="font-family:var(--font-heading);font-size:18px;font-weight:700;color:var(--color-navy);" id="r-s2-pop-rev">Â¥0</span>
                    <span style="font-size:12px;color:#666;">POPæœˆé–“ç²—åˆ©</span>
                    <span style="font-family:var(--font-heading);font-size:18px;font-weight:700;color:#059669;" id="r-s2-pop-gross">Â¥0</span>
                </div>
            </div>

            <!-- BEAUTIFUL Model -->
            <div class="card" style="border:2px solid var(--color-pink);">
                <h3>âœ¨ BEAUTIFUL MODEL â€” ãƒã‚¤ã‚¨ãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ï¼ˆÂ¥8,000ã€œ15,000ï¼‰</h3>
                <div class="note-box" style="margin:0 0 12px;font-size:11px;">ãƒ†ã‚¤ã‚¹ãƒ†ã‚£ãƒ³ã‚°ä½“é¨“ãƒ»ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚·ãƒ³ã‚°ãƒ«ã‚ªãƒªã‚¸ãƒ³ãƒ»ãƒšã‚¢ãƒªãƒ³ã‚°ã‚³ãƒ¼ã‚¹ã€‚ç‰¹åˆ¥ä½“é¨“ã®å®¢å±¤ã€‚</div>
                <div class="card-grid" style="margin-bottom:0;">
                    <div>
                        <div class="control-group">
                            <div class="control-label"><span>1æ—¥ã‚ãŸã‚Šçµ„æ•°</span><span class="control-val" id="v-s2-beau-cups">5</span></div>
                            <input type="range" id="s-s2-beau-cups" min="1" max="20" value="5" oninput="calcInvestment()">
                        </div>
                        <div class="control-group">
                            <div class="control-label"><span>å¹³å‡å˜ä¾¡</span><span class="control-val" id="v-s2-beau-price">Â¥10,000</span></div>
                            <input type="range" id="s-s2-beau-price" min="8000" max="15000" step="500" value="10000" oninput="calcInvestment()">
                        </div>
                    </div>
                    <div>
                        <div class="control-group">
                            <div class="control-label"><span>åŸä¾¡ / çµ„</span><span class="control-val" id="v-s2-beau-bean">Â¥2,000</span></div>
                            <input type="range" id="s-s2-beau-bean" min="500" max="5000" step="100" value="2000" oninput="calcInvestment()">
                        </div>
                        <div class="control-group">
                            <div class="control-label"><span>ãã®ä»–åŸä¾¡ / çµ„</span><span class="control-val" id="v-s2-beau-other">Â¥500</span></div>
                            <input type="range" id="s-s2-beau-other" min="100" max="2000" step="50" value="500" oninput="calcInvestment()">
                        </div>
                    </div>
                </div>
                <div style="background:#f8f9fc;border-radius:8px;padding:10px 16px;margin-top:12px;display:flex;justify-content:space-between;align-items:center;">
                    <span style="font-size:12px;color:#666;">BEAUTIFULæœˆé–“å£²ä¸Š</span>
                    <span style="font-family:var(--font-heading);font-size:18px;font-weight:700;color:var(--color-navy);" id="r-s2-beau-rev">Â¥0</span>
                    <span style="font-size:12px;color:#666;">BEAUTIFULæœˆé–“ç²—åˆ©</span>
                    <span style="font-family:var(--font-heading);font-size:18px;font-weight:700;color:#059669;" id="r-s2-beau-gross">Â¥0</span>
                </div>
            </div>

            <!-- Shared Store Costs -->
            <div class="card-grid" style="margin:16px 0;">
                <div>
                    <div style="font-family:var(--font-heading);font-size:12px;font-weight:700;color:var(--color-navy);letter-spacing:0.06em;margin-bottom:12px;">ğŸ  S2 å…±é€šå›ºå®šã‚³ã‚¹ãƒˆ</div>
                    <div class="control-group">
                        <div class="control-label"><span>å–¶æ¥­æ—¥æ•° / æœˆ</span><span class="control-val" id="v-s2-days">25</span></div>
                        <input type="range" id="s-s2-days" min="15" max="30" value="25" oninput="calcInvestment()">
                    </div>
                    <div class="control-group">
                        <div class="control-label"><span>åº§å¸­æ•°</span><span class="control-val" id="v-s2-seats">15</span></div>
                        <input type="range" id="s-s2-seats" min="8" max="40" value="15" oninput="calcInvestment()">
                    </div>
                    <div class="control-group">
                        <div class="control-label"><span>å®¶è³ƒ / æœˆ</span><span class="control-val" id="v-s2-rent">Â¥350,000</span></div>
                        <input type="range" id="s-s2-rent" min="150000" max="800000" step="10000" value="350000" oninput="calcInvestment()">
                    </div>
                    <div class="control-group">
                        <div class="control-label"><span>äººä»¶è²»ï¼ˆãƒãƒªã‚¹ã‚¿Ã—äººæ•°ï¼‰/ æœˆ</span><span class="control-val" id="v-s2-staff">Â¥500,000</span></div>
                        <input type="range" id="s-s2-staff" min="200000" max="1200000" step="20000" value="500000" oninput="calcInvestment()">
                    </div>
                </div>
                <div>
                    <div class="control-group" style="margin-top:28px;">
                        <div class="control-label"><span>å…‰ç†±è²»ãƒ»æ°´é“ / æœˆ</span><span class="control-val" id="v-s2-utility">Â¥80,000</span></div>
                        <input type="range" id="s-s2-utility" min="30000" max="200000" step="5000" value="80000" oninput="calcInvestment()">
                    </div>
                    <div class="control-group">
                        <div class="control-label"><span>æ¶ˆè€—å“ãƒ»é›‘è²» / æœˆ</span><span class="control-val" id="v-s2-misc">Â¥50,000</span></div>
                        <input type="range" id="s-s2-misc" min="20000" max="150000" step="5000" value="50000" oninput="calcInvestment()">
                    </div>
                    <div style="font-family:var(--font-heading);font-size:12px;font-weight:700;color:var(--color-navy);letter-spacing:0.06em;margin:16px 0 12px;">ğŸ S2 ã‚°ãƒƒã‚º</div>
                    <div class="control-group">
                        <div class="control-label"><span>ã‚°ãƒƒã‚ºæœˆé–“å£²ä¸Š</span><span class="control-val" id="v-s2-goods-rev">Â¥500,000</span></div>
                        <input type="range" id="s-s2-goods-rev" min="0" max="2000000" step="50000" value="500000" oninput="calcInvestment()">
                    </div>
                    <div class="control-group">
                        <div class="control-label"><span>ã‚°ãƒƒã‚ºåŸä¾¡ç‡</span><span class="control-val" id="v-s2-goods-cogs">35%</span></div>
                        <input type="range" id="s-s2-goods-cogs" min="15" max="60" value="35" oninput="calcInvestment()">
                    </div>
                </div>
            </div>

            <!-- S2 Monthly P&L Summary -->
            <div class="result-banner" id="s2-result-banner" style="background:linear-gradient(135deg,#059669,#047857);">
                <h2>S2 MONTHLY PROFITï¼ˆäºˆæƒ³ï¼‰</h2>
                <div class="result-big positive" id="r-s2-monthly-profit">Â¥0</div>
                <div class="result-sub" id="r-s2-monthly-formula">POP + BEAUTIFUL + ã‚°ãƒƒã‚º âˆ’ å›ºå®šã‚³ã‚¹ãƒˆ</div>
                <div class="result-grid" style="grid-template-columns:repeat(4,1fr);">
                    <div class="result-item">
                        <div class="ri-val" style="color:var(--color-cyan);" id="r-s2-pop-total">Â¥0</div>
                        <div class="ri-label">POPå£²ä¸Š</div>
                    </div>
                    <div class="result-item">
                        <div class="ri-val" style="color:var(--color-pink);" id="r-s2-beau-total">Â¥0</div>
                        <div class="ri-label">BEAUTIFULå£²ä¸Š</div>
                    </div>
                    <div class="result-item">
                        <div class="ri-val" style="color:white;" id="r-s2-cafe-rev">Â¥0</div>
                        <div class="ri-label">ã‚«ãƒ•ã‚§åˆè¨ˆå£²ä¸Š</div>
                    </div>
                    <div class="result-item">
                        <div class="ri-val" style="color:#fde68a;" id="r-s2-cafe-profit">Â¥0</div>
                        <div class="ri-label">å–¶æ¥­åˆ©ç›Š</div>
                    </div>
                </div>
            </div>

            <!-- S2 Revenue Share -->
            <div class="card" style="border:2px solid var(--color-cyan);margin:20px 0;">
                <h3>ğŸ“Š S2 ãƒ¬ãƒ™ãƒ‹ãƒ¥ãƒ¼ã‚·ã‚§ã‚¢æ¯”ç‡ï¼ˆPOPX / greekeeï¼‰</h3>
                <div class="card-grid" style="margin-bottom:0;">
                    <div>
                        <div class="control-group">
                            <div class="control-label"><span>ã‚«ãƒ•ã‚§åˆ©ç›Š POPXå–ã‚Šåˆ†</span><span class="control-val" id="v-s2-cafe-popx">80%</span></div>
                            <input type="range" id="s-s2-cafe-popx" min="0" max="100" step="5" value="80" oninput="calcInvestment()">
                        </div>
                        <div class="split-bar-container">
                            <div class="split-bar">
                                <div class="split-popx" id="bar-s2-cafe-popx" style="width:80%">POPX 80%</div>
                                <div class="split-greekee" id="bar-s2-cafe-gk" style="width:20%">greekee 20%</div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="control-group">
                            <div class="control-label"><span>ã‚°ãƒƒã‚ºåˆ©ç›Š POPXå–ã‚Šåˆ†</span><span class="control-val" id="v-s2-goods-popx">70%</span></div>
                            <input type="range" id="s-s2-goods-popx" min="0" max="100" step="5" value="70" oninput="calcInvestment()">
                        </div>
                        <div class="split-bar-container">
                            <div class="split-bar">
                                <div class="split-popx" id="bar-s2-goods-popx" style="width:70%">POPX 70%</div>
                                <div class="split-greekee" id="bar-s2-goods-gk" style="width:30%">greekee 30%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- S2 Recovery Parameters -->
            <div class="card-grid" style="margin:20px 0 16px;">
                <div>
                    <div style="font-family:var(--font-heading);font-size:12px;font-weight:700;color:var(--color-navy);letter-spacing:0.06em;margin-bottom:12px;">ğŸ“ˆ æˆé•· &amp; å›å</div>
                    <div class="control-group">
                        <div class="control-label"><span>S2 æ¯æ•°æˆé•·ç‡ / æœˆ</span><span class="control-val" id="v-s2-growth">3%</span></div>
                        <input type="range" id="s-s2-growth" min="0" max="15" value="3" oninput="calcInvestment()">
                    </div>
                    <div class="control-group">
                        <div class="control-label"><span>S2 æ¯æ•°ä¸Šé™ / æ—¥</span><span class="control-val" id="v-s2-cups-cap">80</span></div>
                        <input type="range" id="s-s2-cups-cap" min="30" max="150" value="80" oninput="calcInvestment()">
                    </div>
                </div>
                <div>
                    <div class="control-group">
                        <div class="control-label"><span>æŠ•è³‡å›åå……å½“ç‡</span><span class="control-val" id="v-s2-recovery-rate">60%</span></div>
                        <input type="range" id="s-s2-recovery-rate" min="30" max="100" step="5" value="60" oninput="calcInvestment()">
                    </div>
                    <div class="note-box" style="margin:0;font-size:11px;">
                        å–¶æ¥­åˆ©ç›Šã®ä½•%ã‚’æŠ•è³‡å›åã«å……ã¦ã‚‹ã‹ï¼ˆæ®‹ã‚Šã¯ãƒ¬ãƒ™ãƒ‹ãƒ¥ãƒ¼ã‚·ã‚§ã‚¢ã¨ã—ã¦åˆ†é…ï¼‰
                    </div>
                </div>
            </div>

            <!-- Recovery Progress -->
            <div style="background:#f8f9fc;border-radius:12px;padding:20px;margin:16px 0;">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                    <div style="font-family:var(--font-heading);font-size:12px;font-weight:700;color:var(--color-navy);">æŠ•è³‡å›åé€²æ—</div>
                    <div style="font-family:var(--font-heading);font-size:14px;font-weight:700;color:#059669;" id="recovery-pct">0%</div>
                </div>
                <div class="recovery-bar-bg">
                    <div class="recovery-bar-fill" id="recovery-bar" style="width:0%"></div>
                </div>
                <div style="display:flex;justify-content:space-between;margin-top:12px;">
                    <div>
                        <div style="font-size:11px;color:#999;">å›åæ¸ˆã¿</div>
                        <div style="font-family:var(--font-heading);font-size:18px;font-weight:700;color:#059669;" id="recovery-recovered">Â¥0</div>
                    </div>
                    <div style="text-align:center;">
                        <div style="font-size:11px;color:#999;">å›åå®Œäº†äºˆæƒ³</div>
                        <div style="font-family:var(--font-heading);font-size:18px;font-weight:700;color:var(--color-navy);" id="recovery-months">â€” ãƒ¶æœˆ</div>
                    </div>
                    <div style="text-align:right;">
                        <div style="font-size:11px;color:#999;">æ®‹é¡</div>
                        <div style="font-family:var(--font-heading);font-size:18px;font-weight:700;color:#e74c3c;" id="recovery-remaining">Â¥0</div>
                    </div>
                </div>
            </div>

            <!-- Recovery Timeline Table -->
            <div style="overflow-x:auto;margin-top:16px;">
                <table class="monthly-table" id="recovery-table">
                    <thead>
                        <tr>
                            <th>S2 Month</th>
                            <th>æœˆé–“å£²ä¸Š</th>
                            <th>å–¶æ¥­åˆ©ç›Š</th>
                            <th>å›åå……å½“</th>
                            <th>ç´¯ç©å›å</th>
                            <th>æ®‹é¡</th>
                            <th>POPXåˆ†é…</th>
                            <th>greekeeåˆ†é…</th>
                        </tr>
                    </thead>
                    <tbody id="recovery-body"></tbody>
                </table>
            </div>
        </div>

        <!-- Investment Breakdown -->
        <div class="card">
            <h3>ğŸ“‹ æŠ•è³‡å†…è¨³ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆS2å‡ºåº—ã‚³ã‚¹ãƒˆï¼‰</h3>
            <table class="struct-table">
                <thead><tr><th>é …ç›®</th><th>æ¦‚ç®—</th><th>å‚™è€ƒ</th></tr></thead>
                <tbody>
                    <tr><td>ç‰©ä»¶ä¿è¨¼é‡‘ãƒ»ç¤¼é‡‘</td><td>Â¥3,000,000 ã€œ 5,000,000</td><td>éƒ½å†…10-20åªæƒ³å®š</td></tr>
                    <tr><td>å†…è£…å·¥äº‹</td><td>Â¥5,000,000 ã€œ 10,000,000</td><td>åªå˜ä¾¡50-80ä¸‡</td></tr>
                    <tr><td>è¨­å‚™ï¼ˆã‚¨ã‚¹ãƒ—ãƒ¬ãƒƒã‚½ãƒã‚·ãƒ³ç­‰ï¼‰</td><td>Â¥3,000,000 ã€œ 5,000,000</td><td>ãƒã‚¤ã‚¨ãƒ³ãƒ‰æ©Ÿæ</td></tr>
                    <tr><td>ä»€å™¨ãƒ»å®¶å…·</td><td>Â¥1,000,000 ã€œ 2,000,000</td><td>ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»æ¤…å­ãƒ»ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤</td></tr>
                    <tr><td>åˆæœŸåœ¨åº«</td><td>Â¥500,000 ã€œ 1,000,000</td><td>è±†ãƒ»ã‚°ãƒƒã‚ºãƒ»æ¶ˆè€—å“</td></tr>
                    <tr><td>é‹è»¢è³‡é‡‘ï¼ˆ3ãƒ¶æœˆåˆ†ï¼‰</td><td>Â¥5,000,000 ã€œ 8,000,000</td><td>å®¶è³ƒãƒ»äººä»¶è²»ãƒ»ä»•å…¥ã‚Œ</td></tr>
                    <tr><td>ãã®ä»–ï¼ˆè¨±èªå¯ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰</td><td>Â¥1,000,000 ã€œ 2,000,000</td><td>å–¶æ¥­è¨±å¯ãƒ»ãƒ­ã‚´ãƒ»ãƒ¡ãƒ‹ãƒ¥ãƒ¼</td></tr>
                    <tr style="background:#f8f9fc;font-weight:700;">
                        <td><strong>åˆè¨ˆ</strong></td>
                        <td><strong>Â¥18,500,000 ã€œ 33,000,000</strong></td>
                        <td><strong>ä¸­å¤®å€¤ Â¥25,000,000</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="note-box" style="margin-top: 24px;" id="s3-note">
            <strong>æŠ•è³‡å›åå¾Œï¼ˆS3ãƒ•ã‚§ãƒ¼ã‚ºï¼‰ï¼š</strong>æŠ•è³‡å›åå®Œäº†å¾Œã¯ã€S2åº—èˆ—ã®å–¶æ¥­åˆ©ç›Šã‚’ä¸Šè¨˜ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®ãƒ¬ãƒ™ãƒ‹ãƒ¥ãƒ¼ã‚·ã‚§ã‚¢æ¯”ç‡ã§åˆ†é…ã€‚æŠ•è³‡æ¯”ç‡ã«å¿œã˜ãŸè¿½åŠ ãƒªã‚¿ãƒ¼ãƒ³ã®å–ã‚Šæ±ºã‚ã¯åˆ¥é€”åˆæ„ã€‚
        </div>

    </div>

</div>

<script>
// State

function fmt(n) {
    return '\u00a5' + Math.round(n).toLocaleString();
}

function fmtMan(n) {
    if (Math.abs(n) >= 10000) {
        return '\u00a5' + (n / 10000).toFixed(1) + '\u4e07';
    }
    return fmt(n);
}

function showTab(id) {
    document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('tab-' + id).classList.add('active');
    event.target.classList.add('active');
    if (id === 'simulation') simulate();
    if (id === 'yearly') forecast();
    if (id === 'recovery') calcInvestment();
}

function getSimParams() {
    return {
        days: +document.getElementById('s-days').value,
        cups: +document.getElementById('s-cups').value,
        price: +document.getElementById('s-price').value,
        bean: +document.getElementById('s-bean').value,
        otherCost: +document.getElementById('s-other').value,
        rent: +document.getElementById('s-rent').value,
        barista: +document.getElementById('s-barista').value,
        misc: +document.getElementById('s-misc').value,
        shipping: +document.getElementById('s-shipping').value,
        goodsRev: +document.getElementById('s-goods-rev').value,
        goodsCogs: +document.getElementById('s-goods-cogs').value / 100,
    };
}

function calcMonth(p, cupsOverride, goodsRevOverride) {
    const cups = cupsOverride || p.cups;
    const goodsRev = goodsRevOverride || p.goodsRev;

    const cafeRev = cups * p.price * p.days;
    const cafeCogs = cups * (p.bean + p.otherCost) * p.days;
    const fixedCosts = p.rent + p.barista + p.misc + p.shipping;
    const cafeProfit = cafeRev - cafeCogs - fixedCosts;

    const goodsCost = goodsRev * p.goodsCogs;
    const goodsProfit = goodsRev - goodsCost;

    const totalProfit = cafeProfit + goodsProfit;

    // S1: ALL profit goes to S2 pool. POPX is reimbursed via top-off (cafeCogs).
    const s2Pool = Math.max(0, totalProfit);

    // Theoretical split (using adjustable sliders)
    const s1CafePct = +document.getElementById('s-s1-cafe-popx').value / 100;
    const s1GoodsPct = +document.getElementById('s-s1-goods-popx').value / 100;
    const theoreticalPopxCafe = cafeProfit * s1CafePct;
    const theoreticalGkCafe = cafeProfit * (1 - s1CafePct);
    const theoreticalPopxGoods = goodsProfit * s1GoodsPct;
    const theoreticalGkGoods = goodsProfit * (1 - s1GoodsPct);

    return {
        cafeRev, cafeCogs, fixedCosts, cafeProfit,
        goodsRev, goodsCost, goodsProfit,
        totalProfit,
        s2Pool,
        // Theoretical (S2 onwards)
        theoreticalPopxCafe, theoreticalGkCafe,
        theoreticalPopxGoods, theoreticalGkGoods,
        theoreticalPopxTotal: theoreticalPopxCafe + theoreticalPopxGoods,
        theoreticalGkTotal: theoreticalGkCafe + theoreticalGkGoods,
        // Actual S1 income
        popxActual: cafeCogs, // POPX gets reimbursed via top-off = bean cost + other cost
        gkActual: p.rent + p.barista, // greekee gets fixed top-off only
        cups
    };
}

function simulate() {
    const p = getSimParams();

    // Update display values
    document.getElementById('v-days').textContent = p.days;
    document.getElementById('v-cups').textContent = p.cups;
    document.getElementById('v-price').textContent = '\u00a5' + p.price.toLocaleString();
    document.getElementById('v-bean').textContent = '\u00a5' + p.bean.toLocaleString();
    document.getElementById('v-other').textContent = '\u00a5' + p.otherCost.toLocaleString();
    document.getElementById('v-rent').textContent = '\u00a5' + p.rent.toLocaleString();
    document.getElementById('v-barista').textContent = '\u00a5' + p.barista.toLocaleString();
    document.getElementById('v-misc').textContent = '\u00a5' + p.misc.toLocaleString();
    document.getElementById('v-shipping').textContent = '\u00a5' + p.shipping.toLocaleString();
    document.getElementById('v-goods-rev').textContent = '\u00a5' + p.goodsRev.toLocaleString();
    document.getElementById('v-goods-cogs').textContent = Math.round(p.goodsCogs * 100) + '%';

    const r = calcMonth(p);

    // Results banner
    const totalEl = document.getElementById('r-total');
    totalEl.textContent = fmt(r.totalProfit);
    totalEl.className = 'result-big ' + (r.totalProfit >= 0 ? 'positive' : 'negative');
    document.getElementById('r-cafe-profit').textContent = fmt(r.cafeProfit);
    document.getElementById('r-goods-profit').textContent = fmt(r.goodsProfit);

    // S1 share sliders - update display + bars
    const s1CafePct = +document.getElementById('s-s1-cafe-popx').value;
    const s1GoodsPct = +document.getElementById('s-s1-goods-popx').value;
    document.getElementById('v-s1-cafe-popx').textContent = s1CafePct + '%';
    document.getElementById('v-s1-goods-popx').textContent = s1GoodsPct + '%';
    document.getElementById('bar-s1-cafe-popx').style.width = s1CafePct + '%';
    document.getElementById('bar-s1-cafe-popx').textContent = 'POPX ' + s1CafePct + '%';
    document.getElementById('bar-s1-cafe-gk').style.width = (100 - s1CafePct) + '%';
    document.getElementById('bar-s1-cafe-gk').textContent = 'greekee ' + (100 - s1CafePct) + '%';
    document.getElementById('bar-s1-goods-popx').style.width = s1GoodsPct + '%';
    document.getElementById('bar-s1-goods-popx').textContent = 'POPX ' + s1GoodsPct + '%';
    document.getElementById('bar-s1-goods-gk').style.width = (100 - s1GoodsPct) + '%';
    document.getElementById('bar-s1-goods-gk').textContent = 'greekee ' + (100 - s1GoodsPct) + '%';

    // POPX theoretical (pooled)
    document.getElementById('f-popx-cafe-formula').textContent =
        `\u30ab\u30d5\u30a7\u4e8b\u696d\u5229\u76ca ${fmt(r.cafeProfit)} \u00d7 ${s1CafePct}% = ${fmt(r.theoreticalPopxCafe)}`;
    document.getElementById('r-popx-cafe-pooled').textContent = fmt(r.theoreticalPopxCafe);
    document.getElementById('f-popx-goods-formula').textContent =
        `\u30b0\u30c3\u30ba\u4e8b\u696d\u5229\u76ca ${fmt(r.goodsProfit)} \u00d7 ${s1GoodsPct}% = ${fmt(r.theoreticalPopxGoods)}`;
    document.getElementById('r-popx-goods-pooled').textContent = fmt(r.theoreticalPopxGoods);
    document.getElementById('r-popx-total-pooled').textContent = `\u5408\u8a08: ${fmt(r.theoreticalPopxTotal)}`;
    document.getElementById('f-popx-actual-formula').textContent =
        `${p.cups}\u676f \u00d7 (\u00a5${p.bean} + \u00a5${p.otherCost}) \u00d7 ${p.days}\u65e5 = ${fmt(r.cafeCogs)}`;
    document.getElementById('r-popx-actual').textContent = fmt(r.popxActual);

    // greekee theoretical (pooled)
    document.getElementById('f-gk-cafe-formula').textContent =
        `\u30ab\u30d5\u30a7\u4e8b\u696d\u5229\u76ca ${fmt(r.cafeProfit)} \u00d7 ${100 - s1CafePct}% = ${fmt(r.theoreticalGkCafe)}`;
    document.getElementById('r-gk-cafe-pooled').textContent = fmt(r.theoreticalGkCafe);
    document.getElementById('f-gk-goods-formula').textContent =
        `\u30b0\u30c3\u30ba\u4e8b\u696d\u5229\u76ca ${fmt(r.goodsProfit)} \u00d7 ${100 - s1GoodsPct}% = ${fmt(r.theoreticalGkGoods)}`;
    document.getElementById('r-gk-goods-pooled').textContent = fmt(r.theoreticalGkGoods);
    document.getElementById('r-gk-total-pooled').textContent = `\u5408\u8a08: ${fmt(r.theoreticalGkTotal)}`;
    document.getElementById('r-gk-rent').textContent = fmt(p.rent);
    document.getElementById('r-gk-barista').textContent = fmt(p.barista);
    document.getElementById('r-gk-actual').textContent = fmt(r.gkActual);

    // S2 Pool banner
    document.getElementById('r-s2-pool-amount').textContent = fmt(r.s2Pool);
    document.getElementById('r-s2-pool-formula').textContent =
        `\u4e8b\u696d\u5229\u76ca ${fmt(r.totalProfit)} \u2192 \u5168\u984dS2\u30d7\u30fc\u30eb\uff08POPX\u56de\u53ce = cafeCogs ${fmt(r.cafeCogs)}\uff09`;

    // Waterfall
    document.getElementById('w-cafe-rev').textContent = fmt(r.cafeRev);
    document.getElementById('w-cafe-cogs').textContent = '-' + fmt(r.cafeCogs);
    document.getElementById('w-rent').textContent = '-' + fmt(p.rent);
    document.getElementById('w-barista').textContent = '-' + fmt(p.barista);
    document.getElementById('w-misc').textContent = '-' + fmt(p.misc);
    document.getElementById('w-shipping').textContent = '-' + fmt(p.shipping);
    const wpEl = document.getElementById('w-cafe-profit');
    wpEl.textContent = fmt(r.cafeProfit);
    wpEl.className = 'cost-value ' + (r.cafeProfit >= 0 ? 'green' : 'red');
    document.getElementById('w-goods-rev').textContent = fmt(r.goodsRev);
    document.getElementById('w-goods-cogs').textContent = '-' + fmt(r.goodsCost);
    const wgEl = document.getElementById('w-goods-profit');
    wgEl.textContent = fmt(r.goodsProfit);
    wgEl.className = 'cost-value ' + (r.goodsProfit >= 0 ? 'green' : 'red');
    const wtEl = document.getElementById('w-total');
    wtEl.textContent = fmt(r.totalProfit);
    wtEl.className = 'cost-value ' + (r.totalProfit >= 0 ? 'green' : 'red');
    document.getElementById('w-popx-cogs-note').textContent = fmt(r.cafeCogs);
    document.getElementById('w-s2-pool').textContent = fmt(r.s2Pool);
}

function forecast() {
    const p = getSimParams();
    const cafeGrowth = +document.getElementById('s-cafe-growth').value / 100;
    const goodsGrowth = +document.getElementById('s-goods-growth').value / 100;
    const cupsCap = +document.getElementById('s-cups-cap').value;
    const s2Target = +document.getElementById('s-s2-target').value;

    document.getElementById('v-cafe-growth').textContent = Math.round(cafeGrowth * 100) + '%';
    document.getElementById('v-goods-growth').textContent = Math.round(goodsGrowth * 100) + '%';
    document.getElementById('v-cups-cap').textContent = cupsCap;
    document.getElementById('v-s2-target').textContent = '\u00a5' + s2Target.toLocaleString();

    let html = '';
    let totalRev = 0, totalProfit = 0, s2Accumulated = 0;
    let totalPopxActual = 0, totalGkActual = 0;
    const months = ['M1','M2','M3','M4','M5','M6','M7','M8','M9','M10','M11','M12'];

    for (let i = 0; i < 12; i++) {
        const cups = Math.min(Math.round(p.cups * Math.pow(1 + cafeGrowth, i)), cupsCap);
        const goodsRev = Math.round(p.goodsRev * Math.pow(1 + goodsGrowth, i));
        const r = calcMonth(p, cups, goodsRev);

        totalRev += r.cafeRev + r.goodsRev;
        totalProfit += r.totalProfit;
        s2Accumulated += r.s2Pool;
        totalPopxActual += r.popxActual;
        totalGkActual += r.gkActual;

        const profitClass = r.totalProfit >= 0 ? 'positive' : 'negative';
        html += `<tr>
            <td>${months[i]}</td>
            <td>${cups}</td>
            <td>${fmt(r.cafeRev)}</td>
            <td>${fmt(r.goodsRev)}</td>
            <td class="${profitClass}">${fmt(r.totalProfit)}</td>
            <td>${fmt(r.cafeCogs)}</td>
            <td>${fmt(r.s2Pool)}</td>
            <td>${fmt(s2Accumulated)}</td>
        </tr>`;
    }

    html += `<tr>
        <td>TOTAL</td>
        <td>\u2014</td>
        <td>\u2014</td>
        <td>\u2014</td>
        <td class="${totalProfit >= 0 ? 'positive' : 'negative'}">${fmt(totalProfit)}</td>
        <td>${fmt(totalPopxActual)}</td>
        <td>${fmt(s2Accumulated)}</td>
        <td>${fmt(s2Accumulated)}</td>
    </tr>`;

    document.getElementById('forecast-body').innerHTML = html;
    document.getElementById('y-total-rev').textContent = fmt(totalRev);
    document.getElementById('y-total-profit').textContent = fmt(totalProfit);
    document.getElementById('y-s2-accumulated').textContent = fmt(s2Accumulated);

    const gap = Math.max(0, s2Target - s2Accumulated);
    document.getElementById('y-gap-to-s2').textContent = gap > 0 ? fmt(gap) : '\u2714 \u9054\u6210';
}

function getS2Params() {
    return {
        seats: +document.getElementById('s-s2-seats').value,
        days: +document.getElementById('s-s2-days').value,
        // POP model
        popCups: +document.getElementById('s-s2-pop-cups').value,
        popPrice: +document.getElementById('s-s2-pop-price').value,
        popBean: +document.getElementById('s-s2-pop-bean').value,
        popOther: +document.getElementById('s-s2-pop-other').value,
        // BEAUTIFUL model
        beauCups: +document.getElementById('s-s2-beau-cups').value,
        beauPrice: +document.getElementById('s-s2-beau-price').value,
        beauBean: +document.getElementById('s-s2-beau-bean').value,
        beauOther: +document.getElementById('s-s2-beau-other').value,
        // Shared
        rent: +document.getElementById('s-s2-rent').value,
        staff: +document.getElementById('s-s2-staff').value,
        utility: +document.getElementById('s-s2-utility').value,
        misc: +document.getElementById('s-s2-misc').value,
        goodsRev: +document.getElementById('s-s2-goods-rev').value,
        goodsCogs: +document.getElementById('s-s2-goods-cogs').value / 100,
        growth: +document.getElementById('s-s2-growth').value / 100,
        cupsCap: +document.getElementById('s-s2-cups-cap').value,
        recoveryRate: +document.getElementById('s-s2-recovery-rate').value / 100,
    };
}

function calcS2Month(s, popCupsOvr, beauCupsOvr) {
    const popCups = popCupsOvr || s.popCups;
    const beauCups = beauCupsOvr || s.beauCups;
    // POP
    const popRev = popCups * s.popPrice * s.days;
    const popCogs = popCups * (s.popBean + s.popOther) * s.days;
    const popGross = popRev - popCogs;
    // BEAUTIFUL
    const beauRev = beauCups * s.beauPrice * s.days;
    const beauCogs = beauCups * (s.beauBean + s.beauOther) * s.days;
    const beauGross = beauRev - beauCogs;
    // Combined cafe
    const cafeRev = popRev + beauRev;
    const cafeCogs = popCogs + beauCogs;
    const fixedCosts = s.rent + s.staff + s.utility + s.misc;
    const cafeProfit = cafeRev - cafeCogs - fixedCosts;
    // Goods
    const goodsCost = s.goodsRev * s.goodsCogs;
    const goodsProfit = s.goodsRev - goodsCost;
    const totalProfit = cafeProfit + goodsProfit;

    return { cafeRev, cafeCogs, fixedCosts, cafeProfit, goodsProfit, totalProfit,
             popRev, popGross, beauRev, beauGross, popCups, beauCups };
}

function calcInvestment() {
    const p = getSimParams();
    const cafeGrowth = +document.getElementById('s-cafe-growth').value / 100;
    const goodsGrowth = +document.getElementById('s-goods-growth').value / 100;
    const cupsCap = +document.getElementById('s-cups-cap').value;
    const s2Target = +document.getElementById('s-s2-target').value;

    const s1Months = +document.getElementById('s-s1-months').value;
    const popxInvest = +document.getElementById('s-popx-invest').value;
    const gkInvest = +document.getElementById('s-gk-invest').value;
    const popxInvestTiming = +document.getElementById('s-popx-invest-timing').value;
    const gkInvestTiming = +document.getElementById('s-gk-invest-timing').value;

    const s = getS2Params();

    // Update S2 display values â€” POP model
    document.getElementById('v-s2-pop-cups').textContent = s.popCups;
    document.getElementById('v-s2-pop-price').textContent = '\u00a5' + s.popPrice.toLocaleString();
    document.getElementById('v-s2-pop-bean').textContent = '\u00a5' + s.popBean.toLocaleString();
    document.getElementById('v-s2-pop-other').textContent = '\u00a5' + s.popOther.toLocaleString();
    // BEAUTIFUL model
    document.getElementById('v-s2-beau-cups').textContent = s.beauCups;
    document.getElementById('v-s2-beau-price').textContent = '\u00a5' + s.beauPrice.toLocaleString();
    document.getElementById('v-s2-beau-bean').textContent = '\u00a5' + s.beauBean.toLocaleString();
    document.getElementById('v-s2-beau-other').textContent = '\u00a5' + s.beauOther.toLocaleString();
    // Shared
    document.getElementById('v-s2-seats').textContent = s.seats;
    document.getElementById('v-s2-days').textContent = s.days;
    document.getElementById('v-s2-rent').textContent = '\u00a5' + s.rent.toLocaleString();
    document.getElementById('v-s2-staff').textContent = '\u00a5' + s.staff.toLocaleString();
    document.getElementById('v-s2-utility').textContent = '\u00a5' + s.utility.toLocaleString();
    document.getElementById('v-s2-misc').textContent = '\u00a5' + s.misc.toLocaleString();
    document.getElementById('v-s2-goods-rev').textContent = '\u00a5' + s.goodsRev.toLocaleString();
    document.getElementById('v-s2-goods-cogs').textContent = Math.round(s.goodsCogs * 100) + '%';
    document.getElementById('v-s2-growth').textContent = Math.round(s.growth * 100) + '%';
    document.getElementById('v-s2-cups-cap').textContent = s.cupsCap;
    document.getElementById('v-s2-recovery-rate').textContent = Math.round(s.recoveryRate * 100) + '%';

    // S2 Revenue Share sliders display + bars
    const s2CafePct = +document.getElementById('s-s2-cafe-popx').value;
    const s2GoodsPct = +document.getElementById('s-s2-goods-popx').value;
    document.getElementById('v-s2-cafe-popx').textContent = s2CafePct + '%';
    document.getElementById('v-s2-goods-popx').textContent = s2GoodsPct + '%';
    document.getElementById('bar-s2-cafe-popx').style.width = s2CafePct + '%';
    document.getElementById('bar-s2-cafe-popx').textContent = 'POPX ' + s2CafePct + '%';
    document.getElementById('bar-s2-cafe-gk').style.width = (100 - s2CafePct) + '%';
    document.getElementById('bar-s2-cafe-gk').textContent = 'greekee ' + (100 - s2CafePct) + '%';
    document.getElementById('bar-s2-goods-popx').style.width = s2GoodsPct + '%';
    document.getElementById('bar-s2-goods-popx').textContent = 'POPX ' + s2GoodsPct + '%';
    document.getElementById('bar-s2-goods-gk').style.width = (100 - s2GoodsPct) + '%';
    document.getElementById('bar-s2-goods-gk').textContent = 'greekee ' + (100 - s2GoodsPct) + '%';

    // Update S1 investment display
    document.getElementById('v-s1-months').textContent = s1Months;
    document.getElementById('v-popx-invest').textContent = '\u00a5' + popxInvest.toLocaleString();
    document.getElementById('v-gk-invest').textContent = '\u00a5' + gkInvest.toLocaleString();
    document.getElementById('v-popx-invest-timing').textContent = `Month ${popxInvestTiming}`;
    document.getElementById('v-gk-invest-timing').textContent = `Month ${gkInvestTiming}`;

    // S2 base month P&L
    const s2Base = calcS2Month(s);
    // Model summaries
    document.getElementById('r-s2-pop-rev').textContent = fmt(s2Base.popRev);
    document.getElementById('r-s2-pop-gross').textContent = fmt(s2Base.popGross);
    document.getElementById('r-s2-beau-rev').textContent = fmt(s2Base.beauRev);
    document.getElementById('r-s2-beau-gross').textContent = fmt(s2Base.beauGross);
    // Banner
    const s2ProfitEl = document.getElementById('r-s2-monthly-profit');
    s2ProfitEl.textContent = fmt(s2Base.totalProfit);
    s2ProfitEl.className = 'result-big ' + (s2Base.totalProfit >= 0 ? 'positive' : 'negative');
    document.getElementById('r-s2-pop-total').textContent = fmt(s2Base.popRev);
    document.getElementById('r-s2-beau-total').textContent = fmt(s2Base.beauRev);
    document.getElementById('r-s2-cafe-rev').textContent = fmt(s2Base.cafeRev);
    document.getElementById('r-s2-cafe-profit').textContent = fmt(s2Base.totalProfit);
    document.getElementById('r-s2-monthly-formula').textContent =
        `POP ${fmt(s2Base.popGross)} + BEAUTIFUL ${fmt(s2Base.beauGross)} - \u56fa\u5b9a ${fmt(s2Base.fixedCosts)} + \u30b0\u30c3\u30ba ${fmt(s2Base.goodsProfit)} = ${fmt(s2Base.totalProfit)}`;

    // Calculate S1 pool
    let s1Pool = 0;
    for (let i = 0; i < s1Months; i++) {
        const cups = Math.min(Math.round(p.cups * Math.pow(1 + cafeGrowth, i)), cupsCap);
        const goodsRev = Math.round(p.goodsRev * Math.pow(1 + goodsGrowth, i));
        const r = calcMonth(p, cups, goodsRev);
        s1Pool += r.s2Pool;
    }

    document.getElementById('inv-s1-pool').textContent = fmt(s1Pool);

    // Total investment
    const totalInvestment = s1Pool + popxInvest + gkInvest;
    document.getElementById('inv-total').textContent = fmt(totalInvestment);
    document.getElementById('inv-s1-pool-summary').textContent = fmt(s1Pool);
    document.getElementById('inv-popx-summary').textContent = fmt(popxInvest);
    document.getElementById('inv-gk-summary').textContent = fmt(gkInvest);

    const targetDiff = totalInvestment - s2Target;
    if (targetDiff >= 0) {
        document.getElementById('inv-target-status').innerHTML =
            `\u2714 S2\u76ee\u6a19 ${fmt(s2Target)} \u306b\u5bfe\u3057\u3066 ${fmt(targetDiff)} \u306e\u4f59\u88d5\u3042\u308a`;
    } else {
        document.getElementById('inv-target-status').innerHTML =
            `\u26a0 S2\u76ee\u6a19 ${fmt(s2Target)} \u306b\u5bfe\u3057\u3066 ${fmt(Math.abs(targetDiff))} \u4e0d\u8db3`;
    }

    // S2 Recovery simulation (48 months max)
    let html = '';
    let cumulativeRecovered = 0;
    let recoveryMonth = null;

    for (let i = 0; i < 48; i++) {
        const popC = Math.min(Math.round(s.popCups * Math.pow(1 + s.growth, i)), s.cupsCap);
        const beauC = Math.min(Math.round(s.beauCups * Math.pow(1 + s.growth, i)), Math.round(s.cupsCap * 0.3));
        const r = calcS2Month(s, popC, beauC);
        const monthProfit = r.totalProfit;
        const recoveryAmount = Math.max(0, Math.round(monthProfit * s.recoveryRate));
        const distributable = Math.max(0, monthProfit - recoveryAmount);

        cumulativeRecovered += recoveryAmount;
        const remaining = Math.max(0, totalInvestment - cumulativeRecovered);

        // Revenue share on distributable portion (weighted by cafe/goods split)
        const cafeDistrib = distributable * (r.cafeProfit / (Math.abs(r.cafeProfit) + Math.abs(r.goodsProfit) || 1));
        const goodsDistrib = distributable - cafeDistrib;
        const popxShare = Math.round(cafeDistrib * s2CafePct / 100 + goodsDistrib * s2GoodsPct / 100);
        const gkShare = Math.round(distributable - popxShare);

        let badge = '';
        if (recoveryMonth === null && cumulativeRecovered >= totalInvestment) {
            recoveryMonth = i + 1;
            badge = ' <span class="badge-s2-ready">RECOVERED</span>';
            cumulativeRecovered = totalInvestment; // cap
        }

        if (i < 24 || (recoveryMonth && i <= recoveryMonth + 2) || i === 47) {
            html += `<tr>
                <td>S2-M${i + 1}${badge}</td>
                <td>${fmt(r.cafeRev + s.goodsRev)}</td>
                <td class="${monthProfit >= 0 ? 'positive' : 'negative'}">${fmt(monthProfit)}</td>
                <td>${fmt(recoveryAmount)}</td>
                <td>${fmt(Math.min(cumulativeRecovered, totalInvestment))}</td>
                <td class="${remaining > 0 ? 'negative' : 'positive'}">${fmt(remaining)}</td>
                <td>${fmt(popxShare)}</td>
                <td>${fmt(gkShare)}</td>
            </tr>`;
        }

        if (recoveryMonth && i > recoveryMonth + 2) break;
    }

    document.getElementById('recovery-body').innerHTML = html;

    // Recovery progress bar
    const pct = totalInvestment > 0 ? Math.min(100, (cumulativeRecovered / totalInvestment) * 100) : 0;
    document.getElementById('recovery-pct').textContent = Math.round(pct) + '%';
    document.getElementById('recovery-bar').style.width = pct + '%';
    document.getElementById('recovery-bar').textContent = pct >= 10 ? Math.round(pct) + '%' : '';
    document.getElementById('recovery-recovered').textContent = fmt(Math.min(cumulativeRecovered, totalInvestment));
    document.getElementById('recovery-months').textContent = recoveryMonth ? `${recoveryMonth} \u30f6\u6708` : '48\u30f6\u6708\u4ee5\u4e0a';
    document.getElementById('recovery-remaining').textContent = fmt(Math.max(0, totalInvestment - cumulativeRecovered));
}

// Sync split sliders between Tab1, S1, and S2
function syncSplitFromTab1() {
    const cafePct = +document.getElementById('s-t1-cafe-popx').value;
    const goodsPct = +document.getElementById('s-t1-goods-popx').value;
    // Update Tab1 display
    updateSplitDisplay('t1', cafePct, goodsPct);
    // Sync to S1 sliders
    document.getElementById('s-s1-cafe-popx').value = cafePct;
    document.getElementById('s-s1-goods-popx').value = goodsPct;
    // Trigger recalculations
    simulate();
}

function syncSplitFromS1() {
    const cafePct = +document.getElementById('s-s1-cafe-popx').value;
    const goodsPct = +document.getElementById('s-s1-goods-popx').value;
    // Sync to Tab1 sliders
    document.getElementById('s-t1-cafe-popx').value = cafePct;
    document.getElementById('s-t1-goods-popx').value = goodsPct;
    updateSplitDisplay('t1', cafePct, goodsPct);
    simulate();
}

function updateSplitDisplay(prefix, cafePct, goodsPct) {
    document.getElementById('v-' + prefix + '-cafe-popx').textContent = cafePct + '%';
    document.getElementById('bar-' + prefix + '-cafe-popx').style.width = cafePct + '%';
    document.getElementById('bar-' + prefix + '-cafe-popx').textContent = 'POPX ' + cafePct + '%';
    document.getElementById('bar-' + prefix + '-cafe-gk').style.width = (100 - cafePct) + '%';
    document.getElementById('bar-' + prefix + '-cafe-gk').textContent = 'greekee ' + (100 - cafePct) + '%';
    document.getElementById('v-' + prefix + '-goods-popx').textContent = goodsPct + '%';
    document.getElementById('bar-' + prefix + '-goods-popx').style.width = goodsPct + '%';
    document.getElementById('bar-' + prefix + '-goods-popx').textContent = 'POPX ' + goodsPct + '%';
    document.getElementById('bar-' + prefix + '-goods-gk').style.width = (100 - goodsPct) + '%';
    document.getElementById('bar-' + prefix + '-goods-gk').textContent = 'greekee ' + (100 - goodsPct) + '%';
}

// Init
simulate();
</script>
</body>
</html>
